import*as e from"react";import{useRef as n,useState as t,useEffect as l,useLayoutEffect as i}from"react";import r from"../../../../node_modules/next/dynamic.js";import{DialogTrigger as o}from"../../../../node_modules/@radix-ui/react-dialog/dist/index.mjs.js";import{Button as a}from"../../ui/button.js";import{Dialog as u,DialogContent as c,DialogClose as d}from"../../ui/dialog.js";var s=r((function(){return import("./excalidraw.js")}),{ssr:!1}),m=function(){var n=e.useState(null),t=n[0],l=n[1];return[t,e.useCallback((function(e){return l(e)}),[])]};function v(r){var v=r.closeOnClickOutside,f=void 0!==v&&v,E=r.onSave,p=r.initialElements,g=r.initialAppState,h=r.initialFiles,k=r.isShown,w=void 0!==k&&k,x=r.onDelete,C=r.onClose,b=n(null),S=m(),L=S[0],j=S[1],y=t(!1),B=y[0],D=y[1],N=t(p),z=N[0],M=N[1],A=t(h),O=A[0],I=A[1];l((function(){null!==b.current&&b.current.focus()}),[]),l((function(){var e,n=null,t=function(e){var n=e.target;null!==b.current&&!b.current.contains(n)&&f&&x()};return null!==b.current&&null!==(n=null===(e=b.current)||void 0===e?void 0:e.parentElement)&&(null==n||n.addEventListener("click",t)),function(){null!==n&&(null==n||n.removeEventListener("click",t))}}),[f,x]),i((function(){var e=b.current,n=function(e){"Escape"===e.key&&x()};return null!==e&&e.addEventListener("keydown",n),function(){null!==e&&e.removeEventListener("keydown",n)}}),[z,O,x]);function _(){return e.createElement(u,{open:B,onOpenChange:D},e.createElement(c,null,"Are you sure you want to discard the changes?"),e.createElement(d,{asChild:!0},e.createElement(a,{onClick:function(){D(!1),C()}},"Discard")),e.createElement(d,{asChild:!0},e.createElement(a,{onClick:function(){return D(!1)}},"Cancel")))}if(!1===w)return null;return e.createElement(u,{open:w},e.createElement(o,null),e.createElement(c,{className:"h-4/6  overflow-hidden p-0 w-[90vw]"},e.createElement("div",{className:"relative",role:"dialog"},e.createElement("div",{className:"h-full w-full",ref:b,tabIndex:-1},e.createElement("div",{className:"h-full w-full"},B&&e.createElement(_,null),e.createElement(s,{onChange:function(e,n,t){M(e),I(t)},excalidrawAPI:j,initialData:{appState:g||{isLoading:!1},elements:p,files:h}}),e.createElement("div",{className:"flex h-full items-center justify-center"},"Loading..."),e.createElement("div",{className:"absolute bottom-0 bottom-5 right-1/2 z-10 flex translate-x-1/2 gap-2"},e.createElement(a,{variant:"outline",onClick:C},"Discard"),e.createElement(a,{onClick:function(){if(z&&z.filter((function(e){return!e.isDeleted})).length>0){var e=null==L?void 0:L.getAppState(),n={exportBackground:null==e?void 0:e.exportBackground,exportScale:null==e?void 0:e.exportScale,exportWithDarkMode:"dark"===(null==e?void 0:e.theme),isBindingEnabled:null==e?void 0:e.isBindingEnabled,isLoading:null==e?void 0:e.isLoading,name:null==e?void 0:e.name,theme:null==e?void 0:e.theme,viewBackgroundColor:null==e?void 0:e.viewBackgroundColor,viewModeEnabled:null==e?void 0:e.viewModeEnabled,zenModeEnabled:null==e?void 0:e.zenModeEnabled,zoom:null==e?void 0:e.zoom};E(z,n,O)}else x()}},"Save")))))))}export{v as ExcalidrawModal,m as useCallbackRefState};
//# sourceMappingURL=excalidraw-modal.js.map
