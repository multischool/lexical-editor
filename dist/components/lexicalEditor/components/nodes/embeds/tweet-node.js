import{__extends as t,__assign as e,__awaiter as r,__generator as n}from"../../../../../node_modules/tslib/tslib.es6.mjs.js";import*as o from"react";import{useRef as i,useState as a,useCallback as c,useEffect as s}from"react";import{BlockWithAlignableContents as u}from"../../../../../node_modules/@lexical/react/LexicalBlockWithAlignableContents.mjs.js";import{DecoratorBlockNode as l}from"../../../../../node_modules/@lexical/react/LexicalDecoratorBlockNode.mjs.js";function d(t){var e=t.getAttribute("data-lexical-tweet-id");return e?{node:h(e)}:null}var m=!0;function p(t){var e=this,l=t.className,d=t.format,p=t.loadingComponent,f=t.nodeKey,h=t.onError,_=t.onLoad,v=t.tweetID,w=i(null),y=i(""),x=a(!1),g=x[0],b=x[1],N=c((function(){return r(e,void 0,void 0,(function(){var t;return n(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,window.twttr.widgets.createTweet(v,w.current)];case 1:return e.sent(),b(!1),m=!1,_&&_(),[3,3];case 2:return t=e.sent(),h&&h(String(t)),[3,3];case 3:return[2]}}))}))}),[h,_,v]);return s((function(){var t;if(v!==y.current){if(b(!0),m){var e=document.createElement("script");e.src="https://platform.twitter.com/widgets.js",e.async=!0,null===(t=document.body)||void 0===t||t.appendChild(e),e.onload=N,h&&(e.onerror=h)}else N();y&&(y.current=v)}}),[N,h,v]),o.createElement(u,{className:l,format:d,nodeKey:f},g?p:null,o.createElement("div",{style:{display:"inline-block",width:"550px"},ref:w}))}var f=function(r){function n(t,e,n){var o=r.call(this,e,n)||this;return o.__id=t,o}return t(n,r),n.getType=function(){return"tweet"},n.clone=function(t){return new n(t.__id,t.__format,t.__key)},n.importJSON=function(t){var e=h(t.id);return e.setFormat(t.format),e},n.prototype.exportJSON=function(){return e(e({},r.prototype.exportJSON.call(this)),{id:this.getId(),type:"tweet",version:1})},n.importDOM=function(){return{div:function(t){return t.hasAttribute("data-lexical-tweet-id")?{conversion:d,priority:2}:null}}},n.prototype.exportDOM=function(){var t=document.createElement("div");t.setAttribute("data-lexical-tweet-id",this.__id);var e=document.createTextNode(this.getTextContent());return t.append(e),{element:t}},n.prototype.getId=function(){return this.__id},n.prototype.getTextContent=function(t,e){return"https://x.com/i/web/status/".concat(this.__id)},n.prototype.decorate=function(t,e){var r=e.theme.embedBlock||{},n={base:r.base||"",focus:r.focus||""};return o.createElement(p,{className:n,format:this.__format,loadingComponent:"Loading...",nodeKey:this.getKey(),tweetID:this.__id})},n}(l);function h(t){return new f(t)}function _(t){return t instanceof f}export{h as $createTweetNode,_ as $isTweetNode,f as TweetNode};
//# sourceMappingURL=tweet-node.js.map
