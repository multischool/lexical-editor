import{useState as e,useRef as t,useEffect as n}from"react";import{useLexicalComposerContext as r}from"../../../../../node_modules/@lexical/react/LexicalComposerContext.mjs.js";import{createCommand as o,$getSelection as i,$isRangeSelection as c,COMMAND_PRIORITY_EDITOR as a,REDO_COMMAND as s,UNDO_COMMAND as u}from"lexical";import{Button as m}from"../../../ui/button.js";import{Tooltip as l,TooltipTrigger as d,TooltipContent as p}from"../../../ui/tooltip.js";import{useReport as f}from"../../editor-hooks/use-report.js";import{CAN_USE_DOM as h}from"../../shared/can-use-dom.js";import w from"../../../../../node_modules/lucide-react/dist/esm/icons/mic.js";var C=o("SPEECH_TO_TEXT_COMMAND"),v={"\n":function(e){e.selection.insertParagraph()},redo:function(e){e.editor.dispatchCommand(s,void 0)},undo:function(e){e.editor.dispatchCommand(u,void 0)}},x=h&&("SpeechRecognition"in window||"webkitSpeechRecognition"in window);var E=x?function(){var o=r()[0],s=e(!1),u=s[0],x=s[1],E=e(!1),R=E[0],g=E[1],T=h&&(window.SpeechRecognition||window.webkitSpeechRecognition),j=t(null),S=f();return n((function(){return u&&null===j.current&&(j.current=new T,j.current.continuous=!0,j.current.interimResults=!0,j.current.addEventListener("result",(function(e){var t=e.results.item(e.resultIndex),n=t.item(0).transcript;S(n),t.isFinal&&o.update((function(){var e=i();if(c(e)){var t=v[n.toLowerCase().trim()];t?t({editor:o,selection:e}):n.match(/\s*\n\s*/)?e.insertParagraph():e.insertText(n)}}))}))),j.current&&(u?j.current.start():j.current.stop()),function(){null!==j.current&&j.current.stop()}}),[T,o,u,S]),n((function(){return o.registerCommand(C,(function(e){return x(e),!0}),a)}),[o]),React.createElement(l,null,React.createElement(d,{asChild:!0},React.createElement(m,{onClick:function(){o.dispatchCommand(C,!R),g(!R)},variant:R?"secondary":"ghost",title:"Speech To Text","aria-label":"".concat(R?"Enable":"Disable"," speech to text"),className:"p-2",size:"sm"},React.createElement(w,{className:"size-4"}))),React.createElement(p,null,"Speech To Text"))}:function(){return null};export{C as SPEECH_TO_TEXT_COMMAND,x as SUPPORT_SPEECH_RECOGNITION,E as SpeechToTextPlugin};
//# sourceMappingURL=speech-to-text-plugin.js.map
