{"version":3,"file":"images-plugin.js","sources":["../../../../../../src/components/lexicalEditor/components/plugins/images-plugin.tsx"],"sourcesContent":[null],"names":["INSERT_IMAGE_COMMAND","createCommand","defaultUploadImageToServer","file","formData","FormData","append","fetch","method","body","response","_a","sent","ok","Error","concat","status","json","imageUrl","console","error","error_1","InsertImageUriDialogBody","onClick","_b","useState","src","setSrc","_c","altText","setAltText","isDisabled","React","createElement","className","Label","htmlFor","Input","id","placeholder","onChange","e","target","value","DialogFooter","Button","type","disabled","InsertImageUploadedDialogBody","_this","this","onClose","onImageUpload","useLexicalComposerContext","_d","isUploading","setIsUploading","_e","setFile","_f","uploadError","setUploadError","_g","previewSrc","setPreviewSrc","files","length","reader_1","FileReader","onload","result","readAsDataURL","formattedName","name","split","slice","join","replace","handleFileChange","accept","alt","__awaiter","log","url","uploadError_1","serverImageUrl","error_2","message","xmlns","fill","viewBox","cx","cy","r","stroke","strokeWidth","d","InsertImageDialog","activeEditor","hasModifier","useRef","useEffect","current","handler","altKey","document","addEventListener","removeEventListener","payload","dispatchCommand","Tabs","defaultValue","TabsList","TabsTrigger","TabsContent","ImagesPlugin","captionsEnabled","editor","hasNodes","ImageNode","mergeRegister","registerCommand","imageNode","$createImageNode","$insertNodes","$isRootOrShadowRoot","getParentOrThrow","$wrapNodeInElement","$createParagraphNode","selectEnd","COMMAND_PRIORITY_EDITOR","DRAGSTART_COMMAND","event","node","$getImageNodeInSelection","dataTransfer","TRANSPARENT_IMAGE","img","setData","setDragImage","JSON","stringify","data","__altText","caption","__caption","height","__height","key","getKey","maxWidth","__maxWidth","showCaption","__showCaption","__src","width","__width","$onDragStart","COMMAND_PRIORITY_HIGH","DRAGOVER_COMMAND","canDropImage","preventDefault","$onDragover","COMMAND_PRIORITY_LOW","DROP_COMMAND","dragData","getData","parse","getDragImageData","range","targetWindow","nodeType","defaultView","ownerDocument","domSelection","CAN_USE_DOM","window","getSelection","getDOMSelection","caretRangeFromPoint","clientX","clientY","rangeParent","collapse","rangeOffset","getRangeAt","getDragSelection","remove","rangeSelection","$createRangeSelection","applyDOMRange","$setSelection","$onDrop","selection","$getSelection","$isNodeSelection","getNodes","$isImageNode","HTMLElement","closest","parentElement"],"mappings":"2lCAiDA,IAGaA,EACXC,EAAc,wBAWhB,SAAeC,EAA2BC,uGAOrB,8BAJXC,EAAW,IAAIC,UACZC,OAAO,QAASH,GAGF,CAAA,EAAAI,MAAM,oBAAqB,CAChDC,OAAQ,OACRC,KAAML,YAGR,KALMM,EAAWC,EAGfC,QAEYC,GACZ,MAAM,IAAIC,MAAM,8BAAAC,OAA8BL,EAASM,SAG5C,MAAA,CAAA,EAAMN,EAASO,eAG5B,MAAO,CAAA,EAHMN,EAAqBC,OAGtBM,iBAGZ,iBADAC,QAAQC,MAAM,yBAA0BC,GAClCA,yBAET,CAEK,SAAUC,EAAyBX,GACvC,IAAAY,EAAOZ,EAAAY,QAIDC,EAAgBC,EAAS,IAAxBC,EAAGF,EAAA,GAAEG,EAAMH,EAAA,GACZI,EAAwBH,EAAS,IAAhCI,EAAOD,EAAA,GAAEE,EAAUF,EAAA,GAEpBG,EAAqB,KAARL,EAEnB,OACEM,EAAAC,cAAA,MAAA,CAAKC,UAAU,mBACbF,EAAKC,cAAA,MAAA,CAAAC,UAAU,cACbF,EAAAC,cAACE,EAAK,CAACC,QAAQ,aAA6B,aAC5CJ,EAAAC,cAACI,EAAK,CACJC,GAAG,YACHC,YAAY,0CACZC,SAAU,SAACC,GAAM,OAAAd,EAAOc,EAAEC,OAAOC,MAAM,EACvCA,MAAOjB,EACM,eAAA,2BAGjBM,EAAKC,cAAA,MAAA,CAAAC,UAAU,cACbF,EAAAC,cAACE,EAAK,CAACC,QAAQ,YAA2B,YAC1CJ,EAAAC,cAACI,EAAK,CACJC,GAAG,WACHC,YAAY,wBACZC,SAAU,SAACC,GAAM,OAAAX,EAAWW,EAAEC,OAAOC,MAAM,EAC3CA,MAAOd,EACM,eAAA,gCAGjBG,EAAAC,cAACW,EAAY,KACXZ,EAAAC,cAACY,EAAM,CACLC,KAAK,SACLC,SAAUhB,EACVR,QAAS,WAAM,OAAAA,EAAQ,CAAEM,QAAOA,EAAEH,IAAGA,GAAG,EAAA,eAC3B,2BAAyB,YAOhD,CAEM,SAAUsB,EAA8BrC,GAA9C,IAmJCsC,EAAAC,KAlJC3B,YACA4B,EAAOxC,EAAAwC,QACPC,EAAazC,EAAAyC,cAMIC,OACX,IAAA7B,EAAgBC,EAAiB,IAA7BD,EAAA,GAAEG,IAAAA,EAAMH,EAAA,GACZI,EAAwBH,EAAiB,IAAxCI,EAAOD,EAAA,GAAEE,EAAUF,EAAA,GACpB0B,EAAgC7B,GAAkB,GAAjD8B,EAAWD,EAAA,GAAEE,EAAcF,EAAA,GAC5BG,EAAkBhC,EAAsB,MAAvCtB,EAAIsD,EAAA,GAAEC,EAAOD,EAAA,GACdE,EAAgClC,EAAwB,MAAvDmC,EAAWD,EAAA,GAAEE,EAAcF,EAAA,GAC5BG,EAA8BrC,EAAiB,IAA9CsC,EAAUD,EAAA,GAAEE,EAAaF,EAAA,GAE1B/B,GAAc5B,GAAQoD,EAsE5B,OACEvB,EAAAC,cAAA,MAAA,CAAKC,UAAU,mBACbF,EAAKC,cAAA,MAAA,CAAAC,UAAU,cACbF,EAAAC,cAACE,EAAK,CAACC,QAAQ,gBAAmC,gBAClDJ,EAAAC,cAACI,EAAK,CACJC,GAAG,eACHQ,KAAK,OACLN,SAAU,SAACC,GAAM,OA3EA,SAACwB,GACxB,GAAIA,GAASA,EAAMC,OAAS,EAAG,CAC7BR,EAAQO,EAAM,IACdJ,EAAe,MAGf,IAAMM,EAAS,IAAIC,WASnB,GARAD,EAAOE,OAAS,WACe,iBAAlBF,EAAOG,QAChBN,EAAcG,EAAOG,SAGzBH,EAAOI,cAAcN,EAAM,KAGtBpC,EAAS,CACZ,IAGM2C,EAHWP,EAAM,GAAGQ,KAEYC,MAAM,KAAKC,MAAM,GAAI,GAAGC,KAAK,KACxBC,QAAQ,QAAS,KAC5D/C,EAAW0C,EACb,CACF,EAqDuBM,CAAiBrC,EAAEC,OAAOuB,MAAM,EACjDc,OAAO,UACM,eAAA,6BAIhBhB,GACC/B,EAAKC,cAAA,MAAA,CAAAC,UAAU,2BACbF,EAAAC,cAAA,MAAA,CACEP,IAAKqC,EACLiB,IAAI,UACJ9C,UAAU,0EAKhBF,EAAKC,cAAA,MAAA,CAAAC,UAAU,cACbF,EAAAC,cAACE,EAAK,CAACC,QAAQ,YAA2B,YAC1CJ,EAAAC,cAACI,EAAK,CACJC,GAAG,WACHC,YAAY,+BACZC,SAAU,SAACC,GAAM,OAAAX,EAAWW,EAAEC,OAAOC,MAAM,EAC3CA,MAAOd,EACM,eAAA,gCAIhB+B,GACC5B,EAAKC,cAAA,MAAA,CAAAC,UAAU,8CAA8C0B,GAG/D5B,EAAAC,cAACW,EAAY,KACXZ,EAACC,cAAAY,EACC,CAAAC,KAAK,SACLC,SAAUhB,EACVR,QArFa,WAAA,OAAA0D,EAAAhC,OAAA,OAAA,GAAA,2EACnB,IAAK9C,EAAM,MAAO,CAAA,GAElBqD,GAAe,GACfK,EAAe,mDAIb1C,QAAQ+D,IAAI9B,GAEPA,EAAD,MAAc,CAAA,EAAA,oBAGF,6BAAA,CAAA,EAAMlD,EAA2BC,kBAAvCgF,EAAMxE,EAAsCC,OAClDe,EAAOwD,GACP5D,EAAQ,CAAEM,QAAOA,EAAEH,IAAKyD,IACpBhC,GAASA,mCAEbU,EAAe,qFACf1C,QAAQC,MAAM,wBAAyBgE,4BAI1B,KAAA,EAAA,MAAA,CAAA,EAAMhC,EAAcjD,WAA7BmE,EAAS3D,EAAyBC,OAClCyE,EAAiBf,EAAOa,IAG9BxD,EAAO0D,GAGP9D,EAAQ,CAAEM,QAAOA,EAAEH,IAAK2D,IAGpBlC,GAASA,2DAGfU,EAAeyB,aAAiBxE,MAAQwE,EAAMC,QAAU,uDACxDpE,QAAQC,MAAM,gBAAiBkE,yBAE/B9B,GAAe,iCA+CE,eAAA,+BAEZD,EACCvB,EAAAC,cAAA,OAAA,CAAMC,UAAU,2BACdF,EAAAC,cAAA,MAAA,CAAKC,UAAU,6CAA6CsD,MAAM,6BAA6BC,KAAK,OAAOC,QAAQ,aACjH1D,EAAQC,cAAA,SAAA,CAAAC,UAAU,aAAayD,GAAG,KAAKC,GAAG,KAAKC,EAAE,KAAKC,OAAO,eAAeC,YAAY,MACxF/D,EAAAC,cAAA,OAAA,CAAMC,UAAU,aAAauD,KAAK,eAAeO,EAAE,qIAKvD,oBAMZ,CACM,SAAUC,EAAkBtF,GAChC,IAAAuF,iBACA/C,EAAOxC,EAAAwC,QACPC,EAAazC,EAAAyC,cAMP+C,EAAcC,GAAO,GAE3BjF,QAAQ+D,IAAI,gBAAiB9B,GAG7BiD,GAAU,WACRF,EAAYG,SAAU,EACtB,IAAMC,EAAU,SAAC9D,GACf0D,EAAYG,QAAU7D,EAAE+D,QAG1B,OADAC,SAASC,iBAAiB,UAAWH,GAC9B,WACLE,SAASE,oBAAoB,UAAWJ,GAE5C,GAAG,CAACL,IAEJ,IAAM3E,EAAU,SAACqF,GACfV,EAAaW,gBAAgB7G,EAAsB4G,GACnDzD,KAGF,OACEnB,EAACC,cAAA6E,EAAK,CAAAC,aAAa,OACjB/E,EAAAC,cAAC+E,EAAQ,CAAC9E,UAAU,UAClBF,EAACC,cAAAgF,GAAYtE,MAAM,MAAMT,UAAU,UAErB,OACdF,EAACC,cAAAgF,EAAY,CAAAtE,MAAM,OAAOT,UAAU,UAAQ,SAI9CF,EAAAC,cAACiF,EAAW,CAACvE,MAAM,OACjBX,EAAAC,cAACX,EAAyB,CAAAC,QAASA,KAErCS,EAAAC,cAACiF,EAAW,CAACvE,MAAM,QACjBX,EAAAC,cAACe,EACC,CAAAzB,QAASA,EACT4B,QAASA,EACTC,cAAeA,KAKzB,CAEM,SAAU+D,EAAaxG,GAC3B,IAAAyG,EAAezG,EAAAyG,gBAKRC,EAAUhE,OAiDjB,OA5CAgD,GAAU,WACR,IAAKgB,EAAOC,SAAS,CAACC,IACpB,MAAM,IAAIzG,MAAM,oDAGlB,OAAO0G,EACLH,EAAOI,gBACLzH,GACA,SAAC4G,GACC,IAAMc,EAAYC,EAAiBf,GAMnC,OALAgB,EAAa,CAACF,IACVG,EAAoBH,EAAUI,qBAChCC,EAAmBL,EAAWM,GAAsBC,aAG/C,CACT,GACAC,GAEFb,EAAOI,gBACLU,GACA,SAACC,GACC,OA2BV,SAAsBA,GACpB,IAAMC,EAAOC,IACb,IAAKD,EACH,OAAO,EAET,IAAME,EAAeH,EAAMG,aAC3B,IAAKA,EACH,OAAO,EAET,IAAMC,EACJ,iFACIC,EAAMhC,SAASxE,cAAc,OAqBnC,OApBAwG,EAAI/G,IAAM8G,EACVD,EAAaG,QAAQ,aAAc,KACnCH,EAAaI,aAAaF,EAAK,EAAG,GAClCF,EAAaG,QACX,6BACAE,KAAKC,UAAU,CACbC,KAAM,CACJjH,QAASwG,EAAKU,UACdC,QAASX,EAAKY,UACdC,OAAQb,EAAKc,SACbC,IAAKf,EAAKgB,SACVC,SAAUjB,EAAKkB,WACfC,YAAanB,EAAKoB,cAClB/H,IAAK2G,EAAKqB,MACVC,MAAOtB,EAAKuB,SAEd9G,KAAM,YAIH,CACT,CA5DiB+G,CAAazB,EACtB,GACA0B,GAEFzC,EAAOI,gBACLsC,GACA,SAAC3B,GACC,OAuDV,SAAqBA,GAEnB,IADaE,IAEX,OAAO,EAEJ0B,EAAa5B,IAChBA,EAAM6B,iBAER,OAAO,CACT,CAhEiBC,CAAY9B,EACrB,GACA+B,GAEF9C,EAAOI,gBACL2C,GACA,SAAChC,GACC,OA2DV,SAAiBA,EAAkBf,GACjC,IAAMgB,EAAOC,IACb,IAAKD,EACH,OAAO,EAET,IAAMS,EA4BR,SAA0BV,SAClBiC,EAA6B,QAAlB1J,EAAAyH,EAAMG,oBAAY,IAAA5H,OAAA,EAAAA,EAAE2J,QAAQ,8BAC7C,IAAKD,EACH,OAAO,KAEH,IAAA7I,EAAiBoH,KAAK2B,MAAMF,GAA1BvH,EAAItB,EAAAsB,KAAEgG,SACd,GAAa,UAAThG,EACF,OAAO,KAGT,OAAOgG,CACT,CAvCe0B,CAAiBpC,GAC9B,IAAKU,EACH,OAAO,EAGT,GADAV,EAAM6B,iBACFD,EAAa5B,GAAQ,CACvB,IAAMqC,EAqDV,SAA0BrC,GACxB,IAAIqC,EACE/H,EAAS0F,EAAM1F,OACfgI,EACM,MAAVhI,EACI,KACoB,IAApBA,EAAOiI,SACJjI,EAAoBkI,YACpBlI,EAAmBmI,cAAcD,YACpCE,EApdgB,SAACJ,GACvB,OAAAK,GAAeL,GAAgBM,QAAQC,eAAiB,IAAxD,CAmdqBC,CAAgBR,GACrC,GAAIjE,SAAS0E,oBACXV,EAAQhE,SAAS0E,oBAAoB/C,EAAMgD,QAAShD,EAAMiD,aACrD,KAAIjD,EAAMkD,aAAgC,OAAjBR,EAI9B,MAAMhK,MAAM,0CAHZgK,EAAaS,SAASnD,EAAMkD,YAAalD,EAAMoD,aAAe,GAC9Df,EAAQK,EAAaW,WAAW,EAGlC,CAEA,OAAOhB,CACT,CAzEkBiB,CAAiBtD,GAC/BC,EAAKsD,SACL,IAAMC,EAAiBC,IACnBpB,SACFmB,EAAeE,cAAcrB,GAE/BsB,EAAcH,GACdvE,EAAOR,gBAAgB7G,EAAsB8I,EAC/C,CACA,OAAO,CACT,CAhFiBkD,CAAQ5D,EAAOf,KAExByC,GAIN,GAAG,CAAC1C,EAAiBC,IAEd,IACT,CAyEA,SAASiB,IACP,IAAM2D,EAAYC,IAClB,IAAKC,EAAiBF,GACpB,OAAO,KAET,IACM5D,EADQ4D,EAAUG,WACL,GACnB,OAAOC,EAAahE,GAAQA,EAAO,IACrC,CAsBA,SAAS2B,EAAa5B,GACpB,IAAM1F,EAAS0F,EAAM1F,OACrB,SACEA,GACAA,aAAkB4J,cACjB5J,EAAO6J,QAAQ,4BAChB7J,EAAO8J,eACP9J,EAAO8J,cAAcD,QAAQ,6BAEjC,CAjcEtM,EAAc"}