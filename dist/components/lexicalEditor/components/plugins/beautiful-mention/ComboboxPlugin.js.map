{"version":3,"file":"ComboboxPlugin.js","sources":["../../../../../../../src/components/lexicalEditor/components/plugins/beautiful-mention/ComboboxPlugin.tsx"],"sourcesContent":[null],"names":["ComboboxOption","_super","itemType","value","displayValue","data","_this","this","comboboxItem","menuOption","MenuOption","__extends","getQueryTextForSearch","editor","text","getEditorState","read","selection","$getSelection","$isRangeSelection","anchor","type","anchorNode","getNode","isSimpleText","anchorOffset","offset","getTextContent","slice","getTextUpToAnchor","useAnchorRef","render","comboboxAnchor","comboboxAnchorClassName","useLexicalComposerContext","_a","useState","setAnchor","_b","anchorChild","setAnchorChild","useEffect","registerRootListener","rootElement","parentElement","height","getBoundingClientRect","newAnchorChild","document","createElement","style","position","left","right","paddingTop","concat","prepend","anchorObserver","ResizeObserver","entry","contentRect","observe","setTimeout","className","disconnect","removeChild","remove","checkForTriggers","triggers","last","split","pop","lastIndexOf","some","t","startsWith","leadOffset","matchingString","replaceableString","ComboboxPlugin","props","onSelectOption","punctuation","autoSpace","loading","triggerFn","onQueryChange","onReset","comboboxComponent","ComboboxComponent","_c","comboboxItemComponent","ComboboxItemComponent","onComboboxOpen","onComboboxClose","onComboboxFocusChange","_d","comboboxAdditionalItems","onComboboxItemSelect","focused","useIsFocused","_e","selectedIndex","setSelectedIndex","_f","triggerMatch","setTriggerMatch","_g","valueMatch","setValueMatch","_h","triggerQueryString","setTriggerQueryString","options","length","useMemo","additionalOptions","map","opt","triggerOptions","trigger","every","o","__spreadArray","filter","_j","comboboxOpen","open","setOpen","highlightOption","useCallback","index","IS_MOBILE","scrollIntoView","el","ref","current","block","handleArrowKeyDown","event","direction","newIndex","preventDefault","stopImmediatePropagation","handleMouseEnter","handleMouseLeave","handleSelectValue","option","update","textNode","$splitNodeContainingQuery","handleSelectTrigger","nodeToReplace","$createTextNode","replace","select","$insertTriggerAtSelection","handleClick","handleKeySelect","handled","handleBackspace","newText","substring","undefined","trim","handleKeyDown","key","ctrlKey","altKey","metaKey","repeat","isCharacterKey","valueTrimmed","handleFocus","handleClickOutside","mergeRegister","registerCommand","KEY_ARROW_DOWN_COMMAND","COMMAND_PRIORITY_LOW","KEY_ARROW_UP_COMMAND","KEY_ENTER_COMMAND","COMMAND_PRIORITY_NORMAL","KEY_TAB_COMMAND","KEY_BACKSPACE_COMMAND","KEY_DOWN_COMMAND","FOCUS_COMMAND","CLICK_COMMAND","KEY_ESCAPE_COMMAND","registerUpdateListener","CAN_USE_DOM","root","getRootElement","handleMousedown","contains","target","addEventListener","removeEventListener","ReactDOM","createPortal","React","role","selected","item","setRefElement","onClick","onMouseEnter","onMouseLeave","onMouseDown","e"],"mappings":"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"}