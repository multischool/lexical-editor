import{createCommand as e,$createTextNode as r,$isParagraphNode as t,$isTextNode as n,$setSelection as o}from"lexical";import{$getSelectionInfo as l,$findBeautifulMentionNodes as u,getPreviousSibling as s,getNextSibling as i,getTextContent as N,$selectEnd as d}from"./mention-utils.js";import{$createBeautifulMentionNode as f}from"./MentionNode.js";import{$isPlaceholderNode as a}from"./PlaceholderNode.js";var c=e("INSERT_MENTION_COMMAND"),v=e("REMOVE_MENTIONS_COMMAND"),M=e("RENAME_MENTIONS_COMMAND"),h=e("OPEN_MENTION_MENU_COMMAND");function E(e,r,t,n){return g(e,r,t,void 0,void 0,n)}function O(e,r,t,n,o,l){return g(e,r,t,n,o,l)}function g(e,o,u,s,i,N){var d=l(e,o);if(!d)return!1;var a=d.node,c=d.selection,v=d.wordCharBeforeCursor,M=d.wordCharAfterCursor,h=d.cursorAtStartOfNode,E=d.cursorAtEndOfNode,O=d.prevNode,g=d.nextNode,m=s?f(u,s,i):r(u),p=[];if(!(t(a)&&h||n(a)))return N&&p.push(r(" ")),p.push(m),c.insertNodes(p),!0;var C=null;return N&&(v||h&&null!==O&&!n(O))&&p.push(r(" ")),p.push(m),N&&(M||E&&null!==g&&!n(g))&&(C=r(" "),p.push(C)),c.insertNodes(p),p.length>1&&(n(m)?m.select():C&&C.selectPrevious()),!0}function m(e,r,t){void 0===t&&(t=!0);for(var l=!1,d=null,f=null,c=0,v=u();c<v.length;c++){var M=v[c],h=M.getTrigger()===e,E=M.getValue()===r;!h||!E&&r||(d=s(M),f=i(M),M.remove(),l=!0,n(d)&&N(d).endsWith(" ")&&f&&N(f).startsWith(" ")&&d.setTextContent(N(d).slice(0,-1)),(null===f||a(f))&&n(d)&&N(d).endsWith(" ")&&d.setTextContent(N(d).trimEnd()))}return l&&t?C(d,f):t||o(null),l}function p(e,r,t,l){void 0===l&&(l=!0);for(var N=null,f=0,a=u();f<a.length;f++){var c=a[f],v=c.getTrigger()===e,M=c.getValue()===t;!v||!M&&t||(N=c,c.setValue(r))}if(N&&l){var h=s(N),E=i(N);C(h,E),E&&n(E)?E.select(0,0):d()}else l||o(null);return null!==N}function C(e,r){r&&n(r)?r.select(0,0):e&&n(e)?e.select():d()}export{O as $insertMentionAtSelection,E as $insertTriggerAtSelection,m as $removeMention,p as $renameMention,c as INSERT_MENTION_COMMAND,h as OPEN_MENTION_MENU_COMMAND,v as REMOVE_MENTIONS_COMMAND,M as RENAME_MENTIONS_COMMAND};
//# sourceMappingURL=mention-commands.js.map
