import"../../../d3-transition/src/selection/index.js";import"../../../d3-zoom/src/transform.js";import{intersectNode as e}from"./intersect/intersect-node.js";import{edgeToId as t,applyTransition as r,applyClass as n,applyStyle as a}from"./util.js";import o from"../../../lodash-es/uniqueId.js";import s from"../../../d3-selection/src/select.js";import i from"../../../d3-shape/src/line.js";import{svg as d}from"../../../d3-fetch/src/xml.js";import c from"../../../lodash-es/range.js";var l=function(i,d,l){var u=i.selectAll("g.edgePath").data(d.edges(),(function(e){return t(e)})).classed("update",!0),h=function(e,t){var r=e.enter().append("g").attr("class","edgePath").style("opacity",0);return r.append("path").attr("class","path").attr("d",(function(e){var r=t.edge(e),n=t.node(e.v).elem;return p(r,c(r.points.length).map((function(){return t=(e=n).getBBox(),{x:(r=e.ownerSVGElement.getScreenCTM().inverse().multiply(e.getScreenCTM()).translate(t.width/2,t.height/2)).e,y:r.f};var e,t,r})))})),r.append("defs"),r}(u,d);!function(e,t){var n=e.exit();r(n,t).style("opacity",0).remove()}(u,d);var f=void 0!==u.merge?u.merge(h):u;return r(f,d).style("opacity",1),f.each((function(e){var t=s(this),r=d.edge(e);r.elem=this,r.id&&t.attr("id",r.id),n(t,r.class,(t.classed("update")?"update ":"")+"edgePath")})),f.selectAll("path.path").each((function(t){var n=d.edge(t);n.arrowheadId=o("arrowhead");var i=s(this).attr("marker-end",(function(){return"url("+(e=location.href,t=n.arrowheadId,e.split("#")[0]+"#"+t+")");var e,t})).style("fill","none");r(i,d).attr("d",(function(t){return function(t,r){var n=t.edge(r),a=t.node(r.v),o=t.node(r.w),s=n.points.slice(1,n.points.length-1);return s.unshift(e(a,s[0])),s.push(e(o,s[s.length-1])),p(n,s)}(d,t)})),a(i,n.style)})),f.selectAll("defs *").remove(),f.selectAll("defs").each((function(e){var t=d.edge(e);(0,l[t.arrowhead])(s(this),t.arrowheadId,t,"arrowhead")})),f};function u(e){l=e}function p(e,t){var r=(i||d.line)().x((function(e){return e.x})).y((function(e){return e.y}));return(r.curve||r.interpolate)(e.curve),r(t)}export{l as createEdgePaths,u as setCreateEdgePaths};
//# sourceMappingURL=create-edge-paths.js.map
