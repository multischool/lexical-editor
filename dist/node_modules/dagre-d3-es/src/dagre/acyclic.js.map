{"version":3,"file":"acyclic.js","sources":["../../../../../node_modules/dagre-d3-es/src/dagre/acyclic.js"],"sourcesContent":["import * as _ from 'lodash-es';\nimport { greedyFAS } from './greedy-fas.js';\n\nexport { run, undo };\n\nfunction run(g) {\n  var fas = g.graph().acyclicer === 'greedy' ? greedyFAS(g, weightFn(g)) : dfsFAS(g);\n  _.forEach(fas, function (e) {\n    var label = g.edge(e);\n    g.removeEdge(e);\n    label.forwardName = e.name;\n    label.reversed = true;\n    g.setEdge(e.w, e.v, label, _.uniqueId('rev'));\n  });\n\n  function weightFn(g) {\n    return function (e) {\n      return g.edge(e).weight;\n    };\n  }\n}\n\nfunction dfsFAS(g) {\n  var fas = [];\n  var stack = {};\n  var visited = {};\n\n  function dfs(v) {\n    if (_.has(visited, v)) {\n      return;\n    }\n    visited[v] = true;\n    stack[v] = true;\n    _.forEach(g.outEdges(v), function (e) {\n      if (_.has(stack, e.w)) {\n        fas.push(e);\n      } else {\n        dfs(e.w);\n      }\n    });\n    delete stack[v];\n  }\n\n  _.forEach(g.nodes(), dfs);\n  return fas;\n}\n\nfunction undo(g) {\n  _.forEach(g.edges(), function (e) {\n    var label = g.edge(e);\n    if (label.reversed) {\n      g.removeEdge(e);\n\n      var forwardName = label.forwardName;\n      delete label.reversed;\n      delete label.forwardName;\n      g.setEdge(e.w, e.v, label, forwardName);\n    }\n  });\n}\n"],"names":["run","g","fas","graph","acyclicer","greedyFAS","e","edge","weight","weightFn","stack","visited","dfs","v","_.has","_.forEach","outEdges","w","push","nodes","dfsFAS","label","removeEdge","forwardName","name","reversed","setEdge","_.uniqueId","undo","edges"],"mappings":"gLAKA,SAASA,EAAIC,GACX,IAAIC,EAA8B,WAAxBD,EAAEE,QAAQC,UAAyBC,EAAUJ,EASvD,SAAkBA,GAChB,OAAO,SAAUK,GACf,OAAOL,EAAEM,KAAKD,GAAGE,MACvB,CACG,CAbyDC,CAASR,IAgBrE,SAAgBA,GACd,IAAIC,EAAM,GACNQ,EAAQ,CAAA,EACRC,EAAU,CAAA,EAEd,SAASC,EAAIC,GACPC,EAAMH,EAASE,KAGnBF,EAAQE,IAAK,EACbH,EAAMG,IAAK,EACXE,EAAUd,EAAEe,SAASH,IAAI,SAAUP,GAC7BQ,EAAMJ,EAAOJ,EAAEW,GACjBf,EAAIgB,KAAKZ,GAETM,EAAIN,EAAEW,EAEd,WACWP,EAAMG,GACd,CAGD,OADAE,EAAUd,EAAEkB,QAASP,GACdV,CACT,CAvC2EkB,CAAOnB,GAChFc,EAAUb,GAAK,SAAUI,GACvB,IAAIe,EAAQpB,EAAEM,KAAKD,GACnBL,EAAEqB,WAAWhB,GACbe,EAAME,YAAcjB,EAAEkB,KACtBH,EAAMI,UAAW,EACjBxB,EAAEyB,QAAQpB,EAAEW,EAAGX,EAAEO,EAAGQ,EAAOM,EAAW,OAC1C,GAOA,CA2BA,SAASC,EAAK3B,GACZc,EAAUd,EAAE4B,SAAS,SAAUvB,GAC7B,IAAIe,EAAQpB,EAAEM,KAAKD,GACnB,GAAIe,EAAMI,SAAU,CAClBxB,EAAEqB,WAAWhB,GAEb,IAAIiB,EAAcF,EAAME,mBACjBF,EAAMI,gBACNJ,EAAME,YACbtB,EAAEyB,QAAQpB,EAAEW,EAAGX,EAAEO,EAAGQ,EAAOE,EAC5B,CACL,GACA"}