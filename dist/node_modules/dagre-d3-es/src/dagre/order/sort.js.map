{"version":3,"file":"sort.js","sources":["../../../../../../node_modules/dagre-d3-es/src/dagre/order/sort.js"],"sourcesContent":["import * as _ from 'lodash-es';\nimport * as util from '../util.js';\n\nexport { sort };\n\nfunction sort(entries, biasRight) {\n  var parts = util.partition(entries, function (entry) {\n    return _.has(entry, 'barycenter');\n  });\n  var sortable = parts.lhs,\n    unsortable = _.sortBy(parts.rhs, function (entry) {\n      return -entry.i;\n    }),\n    vs = [],\n    sum = 0,\n    weight = 0,\n    vsIndex = 0;\n\n  sortable.sort(compareWithBias(!!biasRight));\n\n  vsIndex = consumeUnsortable(vs, unsortable, vsIndex);\n\n  _.forEach(sortable, function (entry) {\n    vsIndex += entry.vs.length;\n    vs.push(entry.vs);\n    sum += entry.barycenter * entry.weight;\n    weight += entry.weight;\n    vsIndex = consumeUnsortable(vs, unsortable, vsIndex);\n  });\n\n  var result = { vs: _.flatten(vs) };\n  if (weight) {\n    result.barycenter = sum / weight;\n    result.weight = weight;\n  }\n  return result;\n}\n\nfunction consumeUnsortable(vs, unsortable, index) {\n  var last;\n  while (unsortable.length && (last = _.last(unsortable)).i <= index) {\n    unsortable.pop();\n    vs.push(last.vs);\n    index++;\n  }\n  return index;\n}\n\nfunction compareWithBias(bias) {\n  return function (entryV, entryW) {\n    if (entryV.barycenter < entryW.barycenter) {\n      return -1;\n    } else if (entryV.barycenter > entryW.barycenter) {\n      return 1;\n    }\n\n    return !bias ? entryV.i - entryW.i : entryW.i - entryV.i;\n  };\n}\n"],"names":["sort","entries","biasRight","bias","parts","util.partition","entry","_.has","sortable","lhs","unsortable","_.sortBy","rhs","i","vs","sum","weight","vsIndex","entryV","entryW","barycenter","consumeUnsortable","_.forEach","length","push","result","_.flatten","index","last","_.last","pop"],"mappings":"+QAKA,SAASA,EAAKC,EAASC,GACrB,IA0CuBC,EA1CnBC,EAAQC,EAAeJ,GAAS,SAAUK,GAC5C,OAAOC,EAAMD,EAAO,aACxB,IACME,EAAWJ,EAAMK,IACnBC,EAAaC,EAASP,EAAMQ,KAAK,SAAUN,GACzC,OAAQA,EAAMO,CACpB,IACIC,EAAK,GACLC,EAAM,EACNC,EAAS,EACTC,EAAU,EAEZT,EAASR,MA8BcG,IA9BSD,EA+BzB,SAAUgB,EAAQC,GACvB,OAAID,EAAOE,WAAaD,EAAOC,YACrB,EACCF,EAAOE,WAAaD,EAAOC,WAC7B,EAGDjB,EAA6BgB,EAAON,EAAIK,EAAOL,EAAxCK,EAAOL,EAAIM,EAAON,CACrC,IArCEI,EAAUI,EAAkBP,EAAIJ,EAAYO,GAE5CK,EAAUd,GAAU,SAAUF,GAC5BW,GAAWX,EAAMQ,GAAGS,OACpBT,EAAGU,KAAKlB,EAAMQ,IACdC,GAAOT,EAAMc,WAAad,EAAMU,OAChCA,GAAUV,EAAMU,OAChBC,EAAUI,EAAkBP,EAAIJ,EAAYO,EAChD,IAEE,IAAIQ,EAAS,CAAEX,GAAIY,EAAUZ,IAK7B,OAJIE,IACFS,EAAOL,WAAaL,EAAMC,EAC1BS,EAAOT,OAASA,GAEXS,CACT,CAEA,SAASJ,EAAkBP,EAAIJ,EAAYiB,GAEzC,IADA,IAAIC,EACGlB,EAAWa,SAAWK,EAAOC,EAAOnB,IAAaG,GAAKc,GAC3DjB,EAAWoB,MACXhB,EAAGU,KAAKI,EAAKd,IACba,IAEF,OAAOA,CACT"}