import{barycenter as r}from"./barycenter.js";import{resolveConflicts as e}from"./resolve-conflicts.js";import{sort as t}from"./sort.js";import o from"../../../../lodash-es/filter.js";import n from"../../../../lodash-es/forEach.js";import i from"../../../../lodash-es/has.js";import s from"../../../../lodash-es/flatten.js";import a from"../../../../lodash-es/isUndefined.js";function c(h,f,d,v){var m=h.children(f),g=h.node(f),b=g?g.borderLeft:void 0,l=g?g.borderRight:void 0,p={};b&&(m=o(m,(function(r){return r!==b&&r!==l})));var w=r(h,m);n(w,(function(r){if(h.children(r.v).length){var e=c(h,r.v,d,v);p[r.v]=e,i(e,"barycenter")&&(o=e,a((t=r).barycenter)?(t.barycenter=o.barycenter,t.weight=o.weight):(t.barycenter=(t.barycenter*t.weight+o.barycenter*o.weight)/(t.weight+o.weight),t.weight+=o.weight))}var t,o}));var y=e(w,d);!function(r,e){n(r,(function(r){r.vs=s(r.vs.map((function(r){return e[r]?e[r].vs:r})))}))}(y,p);var u=t(y,v);if(b&&(u.vs=s([b,u.vs,l]),h.predecessors(b).length)){var j=h.node(h.predecessors(b)[0]),x=h.node(h.predecessors(l)[0]);i(u,"barycenter")||(u.barycenter=0,u.weight=0),u.barycenter=(u.barycenter*u.weight+j.order+x.order)/(u.weight+2),u.weight+=2}return u}export{c as sortSubgraph};
//# sourceMappingURL=sort-subgraph.js.map
