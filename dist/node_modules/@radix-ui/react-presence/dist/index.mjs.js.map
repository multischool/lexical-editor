{"version":3,"file":"index.mjs.js","sources":["../../../../../node_modules/@radix-ui/react-presence/dist/index.mjs"],"sourcesContent":["\"use client\";\n\n// packages/react/presence/src/Presence.tsx\nimport * as React2 from \"react\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { useLayoutEffect } from \"@radix-ui/react-use-layout-effect\";\n\n// packages/react/presence/src/useStateMachine.tsx\nimport * as React from \"react\";\nfunction useStateMachine(initialState, machine) {\n  return React.useReducer((state, event) => {\n    const nextState = machine[state][event];\n    return nextState ?? state;\n  }, initialState);\n}\n\n// packages/react/presence/src/Presence.tsx\nvar Presence = (props) => {\n  const { present, children } = props;\n  const presence = usePresence(present);\n  const child = typeof children === \"function\" ? children({ present: presence.isPresent }) : React2.Children.only(children);\n  const ref = useComposedRefs(presence.ref, getElementRef(child));\n  const forceMount = typeof children === \"function\";\n  return forceMount || presence.isPresent ? React2.cloneElement(child, { ref }) : null;\n};\nPresence.displayName = \"Presence\";\nfunction usePresence(present) {\n  const [node, setNode] = React2.useState();\n  const stylesRef = React2.useRef({});\n  const prevPresentRef = React2.useRef(present);\n  const prevAnimationNameRef = React2.useRef(\"none\");\n  const initialState = present ? \"mounted\" : \"unmounted\";\n  const [state, send] = useStateMachine(initialState, {\n    mounted: {\n      UNMOUNT: \"unmounted\",\n      ANIMATION_OUT: \"unmountSuspended\"\n    },\n    unmountSuspended: {\n      MOUNT: \"mounted\",\n      ANIMATION_END: \"unmounted\"\n    },\n    unmounted: {\n      MOUNT: \"mounted\"\n    }\n  });\n  React2.useEffect(() => {\n    const currentAnimationName = getAnimationName(stylesRef.current);\n    prevAnimationNameRef.current = state === \"mounted\" ? currentAnimationName : \"none\";\n  }, [state]);\n  useLayoutEffect(() => {\n    const styles = stylesRef.current;\n    const wasPresent = prevPresentRef.current;\n    const hasPresentChanged = wasPresent !== present;\n    if (hasPresentChanged) {\n      const prevAnimationName = prevAnimationNameRef.current;\n      const currentAnimationName = getAnimationName(styles);\n      if (present) {\n        send(\"MOUNT\");\n      } else if (currentAnimationName === \"none\" || styles?.display === \"none\") {\n        send(\"UNMOUNT\");\n      } else {\n        const isAnimating = prevAnimationName !== currentAnimationName;\n        if (wasPresent && isAnimating) {\n          send(\"ANIMATION_OUT\");\n        } else {\n          send(\"UNMOUNT\");\n        }\n      }\n      prevPresentRef.current = present;\n    }\n  }, [present, send]);\n  useLayoutEffect(() => {\n    if (node) {\n      let timeoutId;\n      const ownerWindow = node.ownerDocument.defaultView ?? window;\n      const handleAnimationEnd = (event) => {\n        const currentAnimationName = getAnimationName(stylesRef.current);\n        const isCurrentAnimation = currentAnimationName.includes(event.animationName);\n        if (event.target === node && isCurrentAnimation) {\n          send(\"ANIMATION_END\");\n          if (!prevPresentRef.current) {\n            const currentFillMode = node.style.animationFillMode;\n            node.style.animationFillMode = \"forwards\";\n            timeoutId = ownerWindow.setTimeout(() => {\n              if (node.style.animationFillMode === \"forwards\") {\n                node.style.animationFillMode = currentFillMode;\n              }\n            });\n          }\n        }\n      };\n      const handleAnimationStart = (event) => {\n        if (event.target === node) {\n          prevAnimationNameRef.current = getAnimationName(stylesRef.current);\n        }\n      };\n      node.addEventListener(\"animationstart\", handleAnimationStart);\n      node.addEventListener(\"animationcancel\", handleAnimationEnd);\n      node.addEventListener(\"animationend\", handleAnimationEnd);\n      return () => {\n        ownerWindow.clearTimeout(timeoutId);\n        node.removeEventListener(\"animationstart\", handleAnimationStart);\n        node.removeEventListener(\"animationcancel\", handleAnimationEnd);\n        node.removeEventListener(\"animationend\", handleAnimationEnd);\n      };\n    } else {\n      send(\"ANIMATION_END\");\n    }\n  }, [node, send]);\n  return {\n    isPresent: [\"mounted\", \"unmountSuspended\"].includes(state),\n    ref: React2.useCallback((node2) => {\n      if (node2) stylesRef.current = getComputedStyle(node2);\n      setNode(node2);\n    }, [])\n  };\n}\nfunction getAnimationName(styles) {\n  return styles?.animationName || \"none\";\n}\nfunction getElementRef(element) {\n  let getter = Object.getOwnPropertyDescriptor(element.props, \"ref\")?.get;\n  let mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.ref;\n  }\n  getter = Object.getOwnPropertyDescriptor(element, \"ref\")?.get;\n  mayWarn = getter && \"isReactWarning\" in getter && getter.isReactWarning;\n  if (mayWarn) {\n    return element.props.ref;\n  }\n  return element.props.ref || element.ref;\n}\nexport {\n  Presence\n};\n//# sourceMappingURL=index.mjs.map\n"],"names":["Presence","props","present","children","presence","node","setNode","React2","useState","stylesRef","useRef","prevPresentRef","prevAnimationNameRef","initialState","state","send","machine","React","useReducer","event","useStateMachine","mounted","UNMOUNT","ANIMATION_OUT","unmountSuspended","MOUNT","ANIMATION_END","unmounted","useEffect","currentAnimationName","getAnimationName","current","useLayoutEffect","styles","wasPresent","prevAnimationName","display","timeoutId","ownerWindow","ownerDocument","defaultView","window","handleAnimationEnd","isCurrentAnimation","includes","animationName","target","currentFillMode","style","animationFillMode","setTimeout","handleAnimationStart","addEventListener","clearTimeout","removeEventListener","isPresent","ref","useCallback","node2","getComputedStyle","usePresence","child","Children","only","useComposedRefs","element","getter","Object","getOwnPropertyDescriptor","get","mayWarn","isReactWarning","getElementRef","cloneElement","displayName"],"mappings":"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"}