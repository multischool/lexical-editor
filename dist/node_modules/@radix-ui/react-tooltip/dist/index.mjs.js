import*as e from"react";import{composeEventHandlers as t}from"../../primitive/dist/index.mjs.js";import{useComposedRefs as r}from"../../react-compose-refs/dist/index.mjs.js";import{createContextScope as o}from"../../react-context/dist/index.mjs.js";import{DismissableLayer as n}from"../../react-dismissable-layer/dist/index.mjs.js";import{useId as i}from"../../react-id/dist/index.mjs.js";import{createPopperScope as s,Anchor as a,Content as c,Arrow as l,Root as p}from"../../react-popper/dist/index.mjs.js";import{Portal as u}from"../../react-portal/dist/index.mjs.js";import{Presence as d}from"../../react-presence/dist/index.mjs.js";import{Primitive as x}from"../../react-primitive/dist/index.mjs.js";import{Slottable as f}from"../../react-slot/dist/index.mjs.js";import{useControllableState as m}from"../../react-use-controllable-state/dist/index.mjs.js";import{Root as h}from"../../react-visually-hidden/dist/index.mjs.js";import"../../../react/jsx-runtime.js";import{j as g}from"../../../../_virtual/jsx-runtime.js";var[y,v]=o("Tooltip",[s]),b=s(),j="TooltipProvider",w=700,T="tooltip.open",[C,E]=y(j),_=t=>{const{__scopeTooltip:r,delayDuration:o=w,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:s}=t,[a,c]=e.useState(!0),l=e.useRef(!1),p=e.useRef(0);return e.useEffect((()=>{const e=p.current;return()=>window.clearTimeout(e)}),[]),g.exports.jsx(C,{scope:r,isOpenDelayed:a,delayDuration:o,onOpen:e.useCallback((()=>{window.clearTimeout(p.current),c(!1)}),[]),onClose:e.useCallback((()=>{window.clearTimeout(p.current),p.current=window.setTimeout((()=>c(!0)),n)}),[n]),isPointerInTransitRef:l,onPointerInTransitChange:e.useCallback((e=>{l.current=e}),[]),disableHoverableContent:i,children:s})};_.displayName=j;var k="Tooltip",[R,D]=y(k),P=t=>{const{__scopeTooltip:r,children:o,open:n,defaultOpen:s=!1,onOpenChange:a,disableHoverableContent:c,delayDuration:l}=t,u=E(k,t.__scopeTooltip),d=b(r),[x,f]=e.useState(null),h=i(),y=e.useRef(0),v=c??u.disableHoverableContent,j=l??u.delayDuration,w=e.useRef(!1),[C=!1,_]=m({prop:n,defaultProp:s,onChange:e=>{e?(u.onOpen(),document.dispatchEvent(new CustomEvent(T))):u.onClose(),a?.(e)}}),D=e.useMemo((()=>C?w.current?"delayed-open":"instant-open":"closed"),[C]),P=e.useCallback((()=>{window.clearTimeout(y.current),y.current=0,w.current=!1,_(!0)}),[_]),L=e.useCallback((()=>{window.clearTimeout(y.current),y.current=0,_(!1)}),[_]),M=e.useCallback((()=>{window.clearTimeout(y.current),y.current=window.setTimeout((()=>{w.current=!0,_(!0),y.current=0}),j)}),[j,_]);return e.useEffect((()=>()=>{y.current&&(window.clearTimeout(y.current),y.current=0)}),[]),g.exports.jsx(p,{...d,children:g.exports.jsx(R,{scope:r,contentId:h,open:C,stateAttribute:D,trigger:x,onTriggerChange:f,onTriggerEnter:e.useCallback((()=>{u.isOpenDelayed?M():P()}),[u.isOpenDelayed,M,P]),onTriggerLeave:e.useCallback((()=>{v?L():(window.clearTimeout(y.current),y.current=0)}),[L,v]),onOpen:P,onClose:L,disableHoverableContent:v,children:o})})};P.displayName=k;var L="TooltipTrigger",M=e.forwardRef(((o,n)=>{const{__scopeTooltip:i,...s}=o,c=D(L,i),l=E(L,i),p=b(i),u=e.useRef(null),d=r(n,u,c.onTriggerChange),f=e.useRef(!1),m=e.useRef(!1),h=e.useCallback((()=>f.current=!1),[]);return e.useEffect((()=>()=>document.removeEventListener("pointerup",h)),[h]),g.exports.jsx(a,{asChild:!0,...p,children:g.exports.jsx(x.button,{"aria-describedby":c.open?c.contentId:void 0,"data-state":c.stateAttribute,...s,ref:d,onPointerMove:t(o.onPointerMove,(e=>{"touch"!==e.pointerType&&(m.current||l.isPointerInTransitRef.current||(c.onTriggerEnter(),m.current=!0))})),onPointerLeave:t(o.onPointerLeave,(()=>{c.onTriggerLeave(),m.current=!1})),onPointerDown:t(o.onPointerDown,(()=>{f.current=!0,document.addEventListener("pointerup",h,{once:!0})})),onFocus:t(o.onFocus,(()=>{f.current||c.onOpen()})),onBlur:t(o.onBlur,c.onClose),onClick:t(o.onClick,c.onClose)})})}));M.displayName=L;var O="TooltipPortal",[I,H]=y(O,{forceMount:void 0}),N=e=>{const{__scopeTooltip:t,forceMount:r,children:o,container:n}=e,i=D(O,t);return g.exports.jsx(I,{scope:t,forceMount:r,children:g.exports.jsx(d,{present:r||i.open,children:g.exports.jsx(u,{asChild:!0,container:n,children:o})})})};N.displayName=O;var A="TooltipContent",B=e.forwardRef(((e,t)=>{const r=H(A,e.__scopeTooltip),{forceMount:o=r.forceMount,side:n="top",...i}=e,s=D(A,e.__scopeTooltip);return g.exports.jsx(d,{present:o||s.open,children:s.disableHoverableContent?g.exports.jsx(X,{side:n,...i,ref:t}):g.exports.jsx(F,{side:n,...i,ref:t})})})),F=e.forwardRef(((t,o)=>{const n=D(A,t.__scopeTooltip),i=E(A,t.__scopeTooltip),s=e.useRef(null),a=r(o,s),[c,l]=e.useState(null),{trigger:p,onClose:u}=n,d=s.current,{onPointerInTransitChange:x}=i,f=e.useCallback((()=>{l(null),x(!1)}),[x]),m=e.useCallback(((e,t)=>{const r=e.currentTarget,o={x:e.clientX,y:e.clientY},n=function(e,t,r=5){const o=[];switch(t){case"top":o.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":o.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":o.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":o.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return o}(o,function(e,t){const r=Math.abs(t.top-e.y),o=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(r,o,n,i)){case i:return"left";case n:return"right";case r:return"top";case o:return"bottom";default:throw new Error("unreachable")}}(o,r.getBoundingClientRect())),i=function(e){const t=e.slice();return t.sort(((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0)),function(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const o=e[r];for(;t.length>=2;){const e=t[t.length-1],r=t[t.length-2];if(!((e.x-r.x)*(o.y-r.y)>=(e.y-r.y)*(o.x-r.x)))break;t.pop()}t.push(o)}t.pop();const r=[];for(let t=e.length-1;t>=0;t--){const o=e[t];for(;r.length>=2;){const e=r[r.length-1],t=r[r.length-2];if(!((e.x-t.x)*(o.y-t.y)>=(e.y-t.y)*(o.x-t.x)))break;r.pop()}r.push(o)}return r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y?t:t.concat(r)}(t)}([...n,...function(e){const{top:t,right:r,bottom:o,left:n}=e;return[{x:n,y:t},{x:r,y:t},{x:r,y:o},{x:n,y:o}]}(t.getBoundingClientRect())]);l(i),x(!0)}),[x]);return e.useEffect((()=>()=>f()),[f]),e.useEffect((()=>{if(p&&d){const e=e=>m(e,d),t=e=>m(e,p);return p.addEventListener("pointerleave",e),d.addEventListener("pointerleave",t),()=>{p.removeEventListener("pointerleave",e),d.removeEventListener("pointerleave",t)}}}),[p,d,m,f]),e.useEffect((()=>{if(c){const e=e=>{const t=e.target,r={x:e.clientX,y:e.clientY},o=p?.contains(t)||d?.contains(t),n=!function(e,t){const{x:r,y:o}=e;let n=!1;for(let e=0,i=t.length-1;e<t.length;i=e++){const s=t[e].x,a=t[e].y,c=t[i].x,l=t[i].y;a>o!=l>o&&r<(c-s)*(o-a)/(l-a)+s&&(n=!n)}return n}(r,c);o?f():n&&(f(),u())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}}),[p,d,c,u,f]),g.exports.jsx(X,{...t,ref:a})})),[S,K]=y(k,{isInside:!1}),X=e.forwardRef(((t,r)=>{const{__scopeTooltip:o,children:i,"aria-label":s,onEscapeKeyDown:a,onPointerDownOutside:l,...p}=t,u=D(A,o),d=b(o),{onClose:x}=u;return e.useEffect((()=>(document.addEventListener(T,x),()=>document.removeEventListener(T,x))),[x]),e.useEffect((()=>{if(u.trigger){const e=e=>{const t=e.target;t?.contains(u.trigger)&&x()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}}),[u.trigger,x]),g.exports.jsx(n,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:x,children:g.exports.jsxs(c,{"data-state":u.stateAttribute,...d,...p,ref:r,style:{...p.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[g.exports.jsx(f,{children:i}),g.exports.jsx(S,{scope:o,isInside:!0,children:g.exports.jsx(h,{id:u.contentId,role:"tooltip",children:s||i})})]})})}));B.displayName=A;var Y="TooltipArrow",q=e.forwardRef(((e,t)=>{const{__scopeTooltip:r,...o}=e,n=b(r);return K(Y,r).isInside?null:g.exports.jsx(l,{...n,...o,ref:t})}));q.displayName=Y;var z=_,G=P,J=M,Q=N,U=B,V=q;export{V as Arrow,U as Content,Q as Portal,z as Provider,G as Root,P as Tooltip,q as TooltipArrow,B as TooltipContent,N as TooltipPortal,_ as TooltipProvider,M as TooltipTrigger,J as Trigger,v as createTooltipScope};
//# sourceMappingURL=index.mjs.js.map
