{"version":3,"file":"index.mjs.js","sources":["../../../../../node_modules/@radix-ui/react-roving-focus/dist/index.mjs"],"sourcesContent":["\"use client\";\n\n// packages/react/roving-focus/src/roving-focus-group.tsx\nimport * as React from \"react\";\nimport { composeEventHandlers } from \"@radix-ui/primitive\";\nimport { createCollection } from \"@radix-ui/react-collection\";\nimport { useComposedRefs } from \"@radix-ui/react-compose-refs\";\nimport { createContextScope } from \"@radix-ui/react-context\";\nimport { useId } from \"@radix-ui/react-id\";\nimport { Primitive } from \"@radix-ui/react-primitive\";\nimport { useCallbackRef } from \"@radix-ui/react-use-callback-ref\";\nimport { useControllableState } from \"@radix-ui/react-use-controllable-state\";\nimport { useDirection } from \"@radix-ui/react-direction\";\nimport { jsx } from \"react/jsx-runtime\";\nvar ENTRY_FOCUS = \"rovingFocusGroup.onEntryFocus\";\nvar EVENT_OPTIONS = { bubbles: false, cancelable: true };\nvar GROUP_NAME = \"RovingFocusGroup\";\nvar [Collection, useCollection, createCollectionScope] = createCollection(GROUP_NAME);\nvar [createRovingFocusGroupContext, createRovingFocusGroupScope] = createContextScope(\n  GROUP_NAME,\n  [createCollectionScope]\n);\nvar [RovingFocusProvider, useRovingFocusContext] = createRovingFocusGroupContext(GROUP_NAME);\nvar RovingFocusGroup = React.forwardRef(\n  (props, forwardedRef) => {\n    return /* @__PURE__ */ jsx(Collection.Provider, { scope: props.__scopeRovingFocusGroup, children: /* @__PURE__ */ jsx(Collection.Slot, { scope: props.__scopeRovingFocusGroup, children: /* @__PURE__ */ jsx(RovingFocusGroupImpl, { ...props, ref: forwardedRef }) }) });\n  }\n);\nRovingFocusGroup.displayName = GROUP_NAME;\nvar RovingFocusGroupImpl = React.forwardRef((props, forwardedRef) => {\n  const {\n    __scopeRovingFocusGroup,\n    orientation,\n    loop = false,\n    dir,\n    currentTabStopId: currentTabStopIdProp,\n    defaultCurrentTabStopId,\n    onCurrentTabStopIdChange,\n    onEntryFocus,\n    preventScrollOnEntryFocus = false,\n    ...groupProps\n  } = props;\n  const ref = React.useRef(null);\n  const composedRefs = useComposedRefs(forwardedRef, ref);\n  const direction = useDirection(dir);\n  const [currentTabStopId = null, setCurrentTabStopId] = useControllableState({\n    prop: currentTabStopIdProp,\n    defaultProp: defaultCurrentTabStopId,\n    onChange: onCurrentTabStopIdChange\n  });\n  const [isTabbingBackOut, setIsTabbingBackOut] = React.useState(false);\n  const handleEntryFocus = useCallbackRef(onEntryFocus);\n  const getItems = useCollection(__scopeRovingFocusGroup);\n  const isClickFocusRef = React.useRef(false);\n  const [focusableItemsCount, setFocusableItemsCount] = React.useState(0);\n  React.useEffect(() => {\n    const node = ref.current;\n    if (node) {\n      node.addEventListener(ENTRY_FOCUS, handleEntryFocus);\n      return () => node.removeEventListener(ENTRY_FOCUS, handleEntryFocus);\n    }\n  }, [handleEntryFocus]);\n  return /* @__PURE__ */ jsx(\n    RovingFocusProvider,\n    {\n      scope: __scopeRovingFocusGroup,\n      orientation,\n      dir: direction,\n      loop,\n      currentTabStopId,\n      onItemFocus: React.useCallback(\n        (tabStopId) => setCurrentTabStopId(tabStopId),\n        [setCurrentTabStopId]\n      ),\n      onItemShiftTab: React.useCallback(() => setIsTabbingBackOut(true), []),\n      onFocusableItemAdd: React.useCallback(\n        () => setFocusableItemsCount((prevCount) => prevCount + 1),\n        []\n      ),\n      onFocusableItemRemove: React.useCallback(\n        () => setFocusableItemsCount((prevCount) => prevCount - 1),\n        []\n      ),\n      children: /* @__PURE__ */ jsx(\n        Primitive.div,\n        {\n          tabIndex: isTabbingBackOut || focusableItemsCount === 0 ? -1 : 0,\n          \"data-orientation\": orientation,\n          ...groupProps,\n          ref: composedRefs,\n          style: { outline: \"none\", ...props.style },\n          onMouseDown: composeEventHandlers(props.onMouseDown, () => {\n            isClickFocusRef.current = true;\n          }),\n          onFocus: composeEventHandlers(props.onFocus, (event) => {\n            const isKeyboardFocus = !isClickFocusRef.current;\n            if (event.target === event.currentTarget && isKeyboardFocus && !isTabbingBackOut) {\n              const entryFocusEvent = new CustomEvent(ENTRY_FOCUS, EVENT_OPTIONS);\n              event.currentTarget.dispatchEvent(entryFocusEvent);\n              if (!entryFocusEvent.defaultPrevented) {\n                const items = getItems().filter((item) => item.focusable);\n                const activeItem = items.find((item) => item.active);\n                const currentItem = items.find((item) => item.id === currentTabStopId);\n                const candidateItems = [activeItem, currentItem, ...items].filter(\n                  Boolean\n                );\n                const candidateNodes = candidateItems.map((item) => item.ref.current);\n                focusFirst(candidateNodes, preventScrollOnEntryFocus);\n              }\n            }\n            isClickFocusRef.current = false;\n          }),\n          onBlur: composeEventHandlers(props.onBlur, () => setIsTabbingBackOut(false))\n        }\n      )\n    }\n  );\n});\nvar ITEM_NAME = \"RovingFocusGroupItem\";\nvar RovingFocusGroupItem = React.forwardRef(\n  (props, forwardedRef) => {\n    const {\n      __scopeRovingFocusGroup,\n      focusable = true,\n      active = false,\n      tabStopId,\n      ...itemProps\n    } = props;\n    const autoId = useId();\n    const id = tabStopId || autoId;\n    const context = useRovingFocusContext(ITEM_NAME, __scopeRovingFocusGroup);\n    const isCurrentTabStop = context.currentTabStopId === id;\n    const getItems = useCollection(__scopeRovingFocusGroup);\n    const { onFocusableItemAdd, onFocusableItemRemove } = context;\n    React.useEffect(() => {\n      if (focusable) {\n        onFocusableItemAdd();\n        return () => onFocusableItemRemove();\n      }\n    }, [focusable, onFocusableItemAdd, onFocusableItemRemove]);\n    return /* @__PURE__ */ jsx(\n      Collection.ItemSlot,\n      {\n        scope: __scopeRovingFocusGroup,\n        id,\n        focusable,\n        active,\n        children: /* @__PURE__ */ jsx(\n          Primitive.span,\n          {\n            tabIndex: isCurrentTabStop ? 0 : -1,\n            \"data-orientation\": context.orientation,\n            ...itemProps,\n            ref: forwardedRef,\n            onMouseDown: composeEventHandlers(props.onMouseDown, (event) => {\n              if (!focusable) event.preventDefault();\n              else context.onItemFocus(id);\n            }),\n            onFocus: composeEventHandlers(props.onFocus, () => context.onItemFocus(id)),\n            onKeyDown: composeEventHandlers(props.onKeyDown, (event) => {\n              if (event.key === \"Tab\" && event.shiftKey) {\n                context.onItemShiftTab();\n                return;\n              }\n              if (event.target !== event.currentTarget) return;\n              const focusIntent = getFocusIntent(event, context.orientation, context.dir);\n              if (focusIntent !== void 0) {\n                if (event.metaKey || event.ctrlKey || event.altKey || event.shiftKey) return;\n                event.preventDefault();\n                const items = getItems().filter((item) => item.focusable);\n                let candidateNodes = items.map((item) => item.ref.current);\n                if (focusIntent === \"last\") candidateNodes.reverse();\n                else if (focusIntent === \"prev\" || focusIntent === \"next\") {\n                  if (focusIntent === \"prev\") candidateNodes.reverse();\n                  const currentIndex = candidateNodes.indexOf(event.currentTarget);\n                  candidateNodes = context.loop ? wrapArray(candidateNodes, currentIndex + 1) : candidateNodes.slice(currentIndex + 1);\n                }\n                setTimeout(() => focusFirst(candidateNodes));\n              }\n            })\n          }\n        )\n      }\n    );\n  }\n);\nRovingFocusGroupItem.displayName = ITEM_NAME;\nvar MAP_KEY_TO_FOCUS_INTENT = {\n  ArrowLeft: \"prev\",\n  ArrowUp: \"prev\",\n  ArrowRight: \"next\",\n  ArrowDown: \"next\",\n  PageUp: \"first\",\n  Home: \"first\",\n  PageDown: \"last\",\n  End: \"last\"\n};\nfunction getDirectionAwareKey(key, dir) {\n  if (dir !== \"rtl\") return key;\n  return key === \"ArrowLeft\" ? \"ArrowRight\" : key === \"ArrowRight\" ? \"ArrowLeft\" : key;\n}\nfunction getFocusIntent(event, orientation, dir) {\n  const key = getDirectionAwareKey(event.key, dir);\n  if (orientation === \"vertical\" && [\"ArrowLeft\", \"ArrowRight\"].includes(key)) return void 0;\n  if (orientation === \"horizontal\" && [\"ArrowUp\", \"ArrowDown\"].includes(key)) return void 0;\n  return MAP_KEY_TO_FOCUS_INTENT[key];\n}\nfunction focusFirst(candidates, preventScroll = false) {\n  const PREVIOUSLY_FOCUSED_ELEMENT = document.activeElement;\n  for (const candidate of candidates) {\n    if (candidate === PREVIOUSLY_FOCUSED_ELEMENT) return;\n    candidate.focus({ preventScroll });\n    if (document.activeElement !== PREVIOUSLY_FOCUSED_ELEMENT) return;\n  }\n}\nfunction wrapArray(array, startIndex) {\n  return array.map((_, index) => array[(startIndex + index) % array.length]);\n}\nvar Root = RovingFocusGroup;\nvar Item = RovingFocusGroupItem;\nexport {\n  Item,\n  Root,\n  RovingFocusGroup,\n  RovingFocusGroupItem,\n  createRovingFocusGroupScope\n};\n//# sourceMappingURL=index.mjs.map\n"],"names":["ENTRY_FOCUS","EVENT_OPTIONS","bubbles","cancelable","GROUP_NAME","Collection","useCollection","createCollectionScope","createCollection","createRovingFocusGroupContext","createRovingFocusGroupScope","createContextScope","RovingFocusProvider","useRovingFocusContext","RovingFocusGroup","React","forwardRef","props","forwardedRef","jsx","Provider","scope","__scopeRovingFocusGroup","children","Slot","exports","RovingFocusGroupImpl","ref","displayName","orientation","loop","dir","currentTabStopId","currentTabStopIdProp","defaultCurrentTabStopId","onCurrentTabStopIdChange","onEntryFocus","preventScrollOnEntryFocus","groupProps","useRef","composedRefs","useComposedRefs","direction","useDirection","setCurrentTabStopId","useControllableState","prop","defaultProp","onChange","isTabbingBackOut","setIsTabbingBackOut","useState","handleEntryFocus","useCallbackRef","getItems","isClickFocusRef","focusableItemsCount","setFocusableItemsCount","useEffect","node","current","addEventListener","removeEventListener","onItemFocus","useCallback","tabStopId","onItemShiftTab","onFocusableItemAdd","prevCount","onFocusableItemRemove","Primitive","div","tabIndex","style","outline","onMouseDown","composeEventHandlers","onFocus","event","isKeyboardFocus","target","currentTarget","entryFocusEvent","CustomEvent","dispatchEvent","defaultPrevented","items","filter","item","focusable","focusFirst","find","active","id","Boolean","map","onBlur","ITEM_NAME","RovingFocusGroupItem","itemProps","autoId","useId","context","isCurrentTabStop","ItemSlot","span","preventDefault","onKeyDown","key","shiftKey","focusIntent","getDirectionAwareKey","includes","MAP_KEY_TO_FOCUS_INTENT","getFocusIntent","metaKey","ctrlKey","altKey","candidateNodes","reverse","currentIndex","indexOf","startIndex","array","_","index","length","slice","setTimeout","ArrowLeft","ArrowUp","ArrowRight","ArrowDown","PageUp","Home","PageDown","End","candidates","preventScroll","PREVIOUSLY_FOCUSED_ELEMENT","document","activeElement","candidate","focus","Root","Item"],"mappings":"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"}