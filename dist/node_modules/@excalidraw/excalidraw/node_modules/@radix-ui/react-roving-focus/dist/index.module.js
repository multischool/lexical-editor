import e from"../../../../../../@babel/runtime/helpers/esm/extends.js";import{forwardRef as o,createElement as t,useRef as r,useState as n,useEffect as i,useCallback as s}from"react";import{composeEventHandlers as u}from"../../primitive/dist/index.module.js";import{createCollection as c}from"@radix-ui/react-collection";import{useComposedRefs as a}from"../../react-compose-refs/dist/index.module.js";import{createContextScope as l}from"../../react-context/dist/index.module.js";import{useId as d}from"../../react-id/dist/index.module.js";import{Primitive as m}from"../../react-primitive/dist/index.module.js";import{useCallbackRef as p}from"../../react-use-callback-ref/dist/index.module.js";import{useControllableState as f}from"../../react-use-controllable-state/dist/index.module.js";import{useDirection as v}from"../../react-direction/dist/index.module.js";const b="rovingFocusGroup.onEntryFocus",g={bubbles:!1,cancelable:!0},F="RovingFocusGroup",[w,I,x]=c(F),[R,A]=l(F,[x]),[h,S]=R(F),T=o(((o,r)=>t(w.Provider,{scope:o.__scopeRovingFocusGroup},t(w.Slot,{scope:o.__scopeRovingFocusGroup},t(D,e({},o,{ref:r})))))),D=o(((o,c)=>{const{__scopeRovingFocusGroup:l,orientation:d,loop:F=!1,dir:w,currentTabStopId:x,defaultCurrentTabStopId:R,onCurrentTabStopIdChange:A,onEntryFocus:S,...T}=o,D=r(null),E=a(c,D),G=v(w),[y=null,C]=f({prop:x,defaultProp:R,onChange:A}),[_,L]=n(!1),P=p(S),k=I(l),M=r(!1),[B,K]=n(0);return i((()=>{const e=D.current;if(e)return e.addEventListener(b,P),()=>e.removeEventListener(b,P)}),[P]),t(h,{scope:l,orientation:d,dir:G,loop:F,currentTabStopId:y,onItemFocus:s((e=>C(e)),[C]),onItemShiftTab:s((()=>L(!0)),[]),onFocusableItemAdd:s((()=>K((e=>e+1))),[]),onFocusableItemRemove:s((()=>K((e=>e-1))),[])},t(m.div,e({tabIndex:_||0===B?-1:0,"data-orientation":d},T,{ref:E,style:{outline:"none",...o.style},onMouseDown:u(o.onMouseDown,(()=>{M.current=!0})),onFocus:u(o.onFocus,(e=>{const o=!M.current;if(e.target===e.currentTarget&&o&&!_){const o=new CustomEvent(b,g);if(e.currentTarget.dispatchEvent(o),!o.defaultPrevented){const e=k().filter((e=>e.focusable));j([e.find((e=>e.active)),e.find((e=>e.id===y)),...e].filter(Boolean).map((e=>e.ref.current)))}}M.current=!1})),onBlur:u(o.onBlur,(()=>L(!1)))})))})),E=o(((o,r)=>{const{__scopeRovingFocusGroup:n,focusable:s=!0,active:c=!1,tabStopId:a,...l}=o,p=d(),f=a||p,v=S("RovingFocusGroupItem",n),b=v.currentTabStopId===f,g=I(n),{onFocusableItemAdd:F,onFocusableItemRemove:x}=v;return i((()=>{if(s)return F(),()=>x()}),[s,F,x]),t(w.ItemSlot,{scope:n,id:f,focusable:s,active:c},t(m.span,e({tabIndex:b?0:-1,"data-orientation":v.orientation},l,{ref:r,onMouseDown:u(o.onMouseDown,(e=>{s?v.onItemFocus(f):e.preventDefault()})),onFocus:u(o.onFocus,(()=>v.onItemFocus(f))),onKeyDown:u(o.onKeyDown,(e=>{if("Tab"===e.key&&e.shiftKey)return void v.onItemShiftTab();if(e.target!==e.currentTarget)return;const o=function(e,o,t){const r=function(e,o){return"rtl"!==o?e:"ArrowLeft"===e?"ArrowRight":"ArrowRight"===e?"ArrowLeft":e}(e.key,t);return"vertical"===o&&["ArrowLeft","ArrowRight"].includes(r)||"horizontal"===o&&["ArrowUp","ArrowDown"].includes(r)?void 0:G[r]}(e,v.orientation,v.dir);if(void 0!==o){e.preventDefault();let n=g().filter((e=>e.focusable)).map((e=>e.ref.current));if("last"===o)n.reverse();else if("prev"===o||"next"===o){"prev"===o&&n.reverse();const i=n.indexOf(e.currentTarget);n=v.loop?(r=i+1,(t=n).map(((e,o)=>t[(r+o)%t.length]))):n.slice(i+1)}setTimeout((()=>j(n)))}var t,r}))})))})),G={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function j(e){const o=document.activeElement;for(const t of e){if(t===o)return;if(t.focus(),document.activeElement!==o)return}}const y=T,C=E;export{C as Item,y as Root,T as RovingFocusGroup,E as RovingFocusGroupItem,A as createRovingFocusGroupScope};
//# sourceMappingURL=index.module.js.map
