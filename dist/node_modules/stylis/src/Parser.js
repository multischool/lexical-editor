import{COMMENT as e,DECLARATION as a,RULESET as c}from"./Enum.js";import{from as s,strlen as r,append as f,charat as i,replace as t,substr as n,indexof as u,abs as o,sizeof as k,trim as l}from"./Utility.js";import{dealloc as b,alloc as m,next as d,peek as h,delimit as w,identifier as p,commenter as v,token as j,escaping as g,whitespace as x,node as y,char as z,prev as E,caret as T}from"./Tokenizer.js";function U(e){return b(q("",null,null,null,[""],e=m(e),0,[0],e))}function q(e,a,c,k,l,b,m,y,z){for(var U=0,D=0,F=m,G=0,H=0,I=0,J=1,K=1,L=1,M=0,N="",O=l,P=b,Q=k,R=N;K;)switch(I=M,M=d()){case 40:if(108!=I&&58==i(R,F-1)){-1!=u(R+=t(w(M),"&","&\f"),"&\f",o(U?y[U-1]:0))&&(L=-1);break}case 34:case 39:case 91:R+=w(M);break;case 9:case 10:case 13:case 32:R+=x(I);break;case 92:R+=g(T()-1,7);continue;case 47:switch(h()){case 42:case 47:f(B(v(d(),T()),a,c,z),z),5!=j(I||1)&&5!=j(h()||1)||!r(R)||" "===n(R,-1,void 0)||(R+=" ");break;default:R+="/"}break;case 123*J:y[U++]=r(R)*L;case 125*J:case 59:case 0:switch(M){case 0:case 125:K=0;case 59+D:-1==L&&(R=t(R,/\f/g,"")),H>0&&(r(R)-F||0===J&&47===I)&&f(H>32?C(R+";",k,c,F-1,z):C(t(R," ","")+";",k,c,F-2,z),z);break;case 59:R+=";";default:if(f(Q=A(R,a,c,U,D,l,y,N,O=[],P=[],F,b),b),123===M)if(0===D)q(R,a,Q,Q,O,b,F,y,P);else{switch(G){case 99:if(110===i(R,3))break;case 108:if(97===i(R,2))break;default:D=0;case 100:case 109:case 115:}D?q(e,Q,Q,k&&f(A(e,Q,Q,0,0,l,y,N,l,O=[],F,P),P),l,P,F,y,k?O:P):q(R,Q,Q,Q,[""],P,0,y,P)}}U=D=H=0,J=L=1,N=R="",F=m;break;case 58:F=1+r(R),H=I;default:if(J<1)if(123==M)--J;else if(125==M&&0==J++&&125==E())continue;switch(R+=s(M),M*J){case 38:L=D>0?1:(R+="\f",-1);break;case 44:y[U++]=(r(R)-1)*L,L=1;break;case 64:45===h()&&(R+=w(d())),G=h(),D=F=r(N=R+=p(T())),M++;break;case 45:45===I&&2==r(R)&&(J=0)}}return b}function A(e,a,s,r,f,i,u,b,m,d,h,w){for(var p=f-1,v=0===f?i:[""],j=k(v),g=0,x=0,z=0;g<r;++g)for(var E=0,T=n(e,p+1,p=o(x=u[g])),U=e;E<j;++E)(U=l(x>0?v[E]+" "+T:t(T,/&\f/g,v[E])))&&(m[z++]=U);return y(e,a,s,0===f?c:b,m,d,h,w)}function B(a,c,r,f){return y(a,c,r,e,s(z()),n(a,2,-2),0,f)}function C(e,c,s,r,f){return y(e,c,s,a,n(e,0,r),n(e,r+1,-1),r,f)}export{B as comment,U as compile,C as declaration,q as parse,A as ruleset};
//# sourceMappingURL=Parser.js.map
