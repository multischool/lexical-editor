{"version":3,"file":"roundRect.js","sources":["../../../node_modules/canvas-roundrect-polyfill/roundRect.js"],"sourcesContent":["/*\n *  Implements the .roundRect() method of the CanvasPath mixin\n *  as introduced by https://github.com/whatwg/html/pull/6765\n */\n(() => {\n\n  \"use strict\";\n\n  Path2D.prototype.roundRect ??= roundRect;\n  if (globalThis.CanvasRenderingContext2D) {\n\n    globalThis.CanvasRenderingContext2D.prototype.roundRect ??= roundRect;\n\n  }\n  if (globalThis.OffscreenCanvasRenderingContext2D) {\n\n    globalThis.OffscreenCanvasRenderingContext2D.prototype.roundRect ??= roundRect;\n\n  }\n\n  function roundRect(x, y, w, h, radii) {\n\n    if (!([x, y, w, h].every((input) => Number.isFinite(input)))) {\n\n      return;\n\n    }\n\n    radii = parseRadiiArgument(radii);\n\n    let upperLeft, upperRight, lowerRight, lowerLeft;\n\n    if (radii.length === 4) {\n\n      upperLeft = toCornerPoint(radii[0]);\n      upperRight = toCornerPoint(radii[1]);\n      lowerRight = toCornerPoint(radii[2]);\n      lowerLeft = toCornerPoint(radii[3]);\n\n    } else if (radii.length === 3) {\n\n      upperLeft = toCornerPoint(radii[0]);\n      upperRight = toCornerPoint(radii[1]);\n      lowerLeft = toCornerPoint(radii[1]);\n      lowerRight = toCornerPoint(radii[2]);\n\n    } else if (radii.length === 2) {\n\n      upperLeft = toCornerPoint(radii[0]);\n      lowerRight = toCornerPoint(radii[0]);\n      upperRight = toCornerPoint(radii[1]);\n      lowerLeft = toCornerPoint(radii[1]);\n\n    } else if (radii.length === 1) {\n\n      upperLeft = toCornerPoint(radii[0]);\n      upperRight = toCornerPoint(radii[0]);\n      lowerRight = toCornerPoint(radii[0]);\n      lowerLeft = toCornerPoint(radii[0]);\n\n    } else {\n\n      throw new RangeError(`${ getErrorMessageHeader(this) } ${ radii.length } is not a valid size for radii sequence.`);\n\n    }\n\n    const corners = [upperLeft, upperRight, lowerRight, lowerLeft];\n    const negativeCorner = corners.find(({x, y}) => x < 0 || y < 0);\n    const negativeValue = negativeCorner?.x < 0 ? negativeCorner.x : negativeCorner?.y\n\n    if (corners.some(({x, y}) => !Number.isFinite(x) || !Number.isFinite(y))) {\n\n      return;\n\n    }\n\n    if (negativeCorner) {\n\n      throw new RangeError(`${ getErrorMessageHeader(this) } Radius value ${ negativeCorner } is negative.`);\n\n    }\n\n    fixOverlappingCorners(corners);\n\n    if (w < 0 && h < 0) {\n\n      this.moveTo(x - upperLeft.x, y);\n      this.ellipse(x + w + upperRight.x, y - upperRight.y, upperRight.x, upperRight.y, 0, -Math.PI * 1.5, -Math.PI);\n      this.ellipse(x + w + lowerRight.x, y + h + lowerRight.y, lowerRight.x, lowerRight.y, 0, -Math.PI, -Math.PI / 2);\n      this.ellipse(x - lowerLeft.x, y + h + lowerLeft.y, lowerLeft.x, lowerLeft.y, 0, -Math.PI / 2, 0);\n      this.ellipse(x - upperLeft.x, y - upperLeft.y, upperLeft.x, upperLeft.y, 0, 0, -Math.PI / 2);\n\n    } else if (w < 0) {\n\n      this.moveTo(x - upperLeft.x, y);\n      this.ellipse(x + w + upperRight.x, y + upperRight.y, upperRight.x, upperRight.y, 0, -Math.PI / 2, -Math.PI, 1);\n      this.ellipse(x + w + lowerRight.x, y + h - lowerRight.y, lowerRight.x, lowerRight.y, 0, -Math.PI, -Math.PI * 1.5, 1);\n      this.ellipse(x - lowerLeft.x, y + h - lowerLeft.y, lowerLeft.x, lowerLeft.y, 0, Math.PI / 2, 0, 1);\n      this.ellipse(x - upperLeft.x, y + upperLeft.y, upperLeft.x, upperLeft.y, 0, 0, -Math.PI / 2, 1);\n\n    } else if (h < 0) {\n\n      this.moveTo(x + upperLeft.x, y);\n      this.ellipse(x + w - upperRight.x, y - upperRight.y, upperRight.x, upperRight.y, 0, Math.PI / 2, 0, 1);\n      this.ellipse(x + w - lowerRight.x, y + h + lowerRight.y, lowerRight.x, lowerRight.y, 0, 0, -Math.PI / 2, 1);\n      this.ellipse(x + lowerLeft.x, y + h + lowerLeft.y, lowerLeft.x, lowerLeft.y, 0, -Math.PI / 2, -Math.PI, 1);\n      this.ellipse(x + upperLeft.x, y - upperLeft.y, upperLeft.x, upperLeft.y, 0, -Math.PI, -Math.PI * 1.5, 1);\n\n    } else {\n\n      this.moveTo(x + upperLeft.x, y);\n      this.ellipse(x + w - upperRight.x, y + upperRight.y, upperRight.x, upperRight.y, 0, -Math.PI / 2, 0);\n      this.ellipse(x + w - lowerRight.x, y + h - lowerRight.y, lowerRight.x, lowerRight.y, 0, 0, Math.PI / 2);\n      this.ellipse(x + lowerLeft.x, y + h - lowerLeft.y, lowerLeft.x, lowerLeft.y, 0, Math.PI / 2, Math.PI);\n      this.ellipse(x + upperLeft.x, y + upperLeft.y, upperLeft.x, upperLeft.y, 0, Math.PI, Math.PI * 1.5);\n\n    }\n\n    this.closePath();\n    this.moveTo(x, y);\n\n    function toDOMPointInit(value) {\n\n      const {x, y, z, w} = value;\n      return {x, y, z, w};\n\n    }\n\n    function parseRadiiArgument(value) {\n\n      // https://webidl.spec.whatwg.org/#es-union\n      // with 'optional (unrestricted double or DOMPointInit\n      //   or sequence<(unrestricted double or DOMPointInit)>) radii = 0'\n      const type = typeof value;\n\n      if (type === \"undefined\" || value === null) {\n\n        return [0];\n\n      }\n      if (type === \"function\") {\n\n        return [NaN];\n\n      }\n      if (type === \"object\") {\n\n        if (typeof value[Symbol.iterator] === \"function\") {\n\n          return [...value].map((elem) => {\n            // https://webidl.spec.whatwg.org/#es-union\n            // with '(unrestricted double or DOMPointInit)'\n            const elemType = typeof elem;\n            if (elemType === \"undefined\" || elem === null) {\n              return 0;\n            }\n            if (elemType === \"function\") {\n              return NaN;\n            }\n            if (elemType === \"object\") {\n              return toDOMPointInit(elem);\n            }\n            return toUnrestrictedNumber(elem);\n          });\n\n        }\n\n        return [toDOMPointInit(value)];\n\n      }\n\n      return [toUnrestrictedNumber(value)];\n\n    }\n\n    function toUnrestrictedNumber(value) {\n\n      return +value;\n\n    }\n\n    function toCornerPoint(value) {\n\n      const asNumber = toUnrestrictedNumber(value);\n      if (Number.isFinite(asNumber)) {\n\n        return {\n          x: asNumber,\n          y: asNumber\n        };\n\n      }\n      if (Object(value) === value) {\n\n        return {\n          x: toUnrestrictedNumber(value.x ?? 0),\n          y: toUnrestrictedNumber(value.y ?? 0)\n        };\n\n      }\n\n      return {\n        x: NaN,\n        y: NaN\n      };\n\n    }\n\n    function fixOverlappingCorners(corners) {\n\n      const [upperLeft, upperRight, lowerRight, lowerLeft] = corners;\n      const factors = [\n        Math.abs(w) / (upperLeft.x + upperRight.x),\n        Math.abs(h) / (upperRight.y + lowerRight.y),\n        Math.abs(w) / (lowerRight.x + lowerLeft.x),\n        Math.abs(h) / (upperLeft.y + lowerLeft.y)\n      ];\n      const minFactor = Math.min(...factors);\n      if (minFactor <= 1) {\n\n        for (const radii of corners) {\n\n          radii.x *= minFactor;\n          radii.y *= minFactor;\n\n        }\n\n      }\n\n    }\n\n  }\n\n  function getErrorMessageHeader(instance) {\n\n    return `Failed to execute 'roundRect' on '${ getConstructorName(instance) }':`;\n\n  }\n\n  function getConstructorName(instance) {\n\n    return Object(instance) === instance &&\n      instance instanceof Path2D ? \"Path2D\" :\n      instance instanceof globalThis?.CanvasRenderingContext2D ? \"CanvasRenderingContext2D\" :\n      instance instanceof globalThis?.OffscreenCanvasRenderingContext2D ? \"OffscreenCanvasRenderingContext2D\" :\n      instance?.constructor.name ||\n      instance;\n\n  }\n\n})();\n"],"names":["roundRect","x","y","w","h","radii","every","input","Number","isFinite","upperLeft","upperRight","lowerRight","lowerLeft","value","type","NaN","Symbol","iterator","map","elem","elemType","toDOMPointInit","toUnrestrictedNumber","parseRadiiArgument","length","toCornerPoint","RangeError","getErrorMessageHeader","this","corners","negativeCorner","find","some","factors","Math","abs","minFactor","min","fixOverlappingCorners","moveTo","ellipse","PI","closePath","z","asNumber","Object","instance","Path2D","globalThis","CanvasRenderingContext2D","OffscreenCanvasRenderingContext2D","constructor","name","getConstructorName","prototype"],"mappings":"AAIA,MAgBE,SAASA,EAAUC,EAAGC,EAAGC,EAAGC,EAAGC,GAE7B,IAAM,CAACJ,EAAGC,EAAGC,EAAGC,GAAGE,OAAOC,GAAUC,OAAOC,SAASF,KAElD,OAMF,IAAIG,EAAWC,EAAYC,EAAYC,EAEvC,GAAqB,KAJrBR,EAoGA,SAA4BS,GAK1B,MAAMC,SAAcD,EAEpB,GAAa,cAATC,GAAkC,OAAVD,EAE1B,MAAO,CAAC,GAGV,GAAa,aAATC,EAEF,MAAO,CAACC,KAGV,GAAa,WAATD,EAEF,MAAsC,mBAA3BD,EAAMG,OAAOC,UAEf,IAAIJ,GAAOK,KAAKC,IAGrB,MAAMC,SAAkBD,EACxB,MAAiB,cAAbC,GAAqC,OAATD,EACvB,EAEQ,aAAbC,EACKL,IAEQ,WAAbK,EACKC,EAAeF,GAEjBG,EAAqBH,EAAK,IAK9B,CAACE,EAAeR,IAIzB,MAAO,CAACS,EAAqBT,GAE9B,CAjJOU,CAAmBnB,IAIjBoB,OAERf,EAAYgB,EAAcrB,EAAM,IAChCM,EAAae,EAAcrB,EAAM,IACjCO,EAAac,EAAcrB,EAAM,IACjCQ,EAAYa,EAAcrB,EAAM,SAE3B,GAAqB,IAAjBA,EAAMoB,OAEff,EAAYgB,EAAcrB,EAAM,IAChCM,EAAae,EAAcrB,EAAM,IACjCQ,EAAYa,EAAcrB,EAAM,IAChCO,EAAac,EAAcrB,EAAM,SAE5B,GAAqB,IAAjBA,EAAMoB,OAEff,EAAYgB,EAAcrB,EAAM,IAChCO,EAAac,EAAcrB,EAAM,IACjCM,EAAae,EAAcrB,EAAM,IACjCQ,EAAYa,EAAcrB,EAAM,QAE3B,IAAqB,IAAjBA,EAAMoB,OASf,MAAM,IAAIE,WAAW,GAAIC,EAAsBC,SAAWxB,EAAMoB,kDAPhEf,EAAYgB,EAAcrB,EAAM,IAChCM,EAAae,EAAcrB,EAAM,IACjCO,EAAac,EAAcrB,EAAM,IACjCQ,EAAYa,EAAcrB,EAAM,GAMjC,CAED,MAAMyB,EAAU,CAACpB,EAAWC,EAAYC,EAAYC,GAC9CkB,EAAiBD,EAAQE,MAAK,EAAE/B,IAAGC,OAAOD,EAAI,GAAKC,EAAI,IAG7D,GAFsB6B,GAAgB9B,EAAI,GAAI8B,EAAe9B,GAEzD6B,EAAQG,MAAK,EAAEhC,IAAGC,QAAQM,OAAOC,SAASR,KAAOO,OAAOC,SAASP,KAArE,CAMA,GAAI6B,EAEF,MAAM,IAAIJ,WAAW,GAAIC,EAAsBC,sBAAwBE,mBAkIzE,SAA+BD,GAE7B,MAAOpB,EAAWC,EAAYC,EAAYC,GAAaiB,EACjDI,EAAU,CACdC,KAAKC,IAAIjC,IAAMO,EAAUT,EAAIU,EAAWV,GACxCkC,KAAKC,IAAIhC,IAAMO,EAAWT,EAAIU,EAAWV,GACzCiC,KAAKC,IAAIjC,IAAMS,EAAWX,EAAIY,EAAUZ,GACxCkC,KAAKC,IAAIhC,IAAMM,EAAUR,EAAIW,EAAUX,IAEnCmC,EAAYF,KAAKG,OAAOJ,GAC9B,GAAIG,GAAa,EAEf,IAAK,MAAMhC,KAASyB,EAElBzB,EAAMJ,GAAKoC,EACXhC,EAAMH,GAAKmC,CAMhB,CAnJDE,CAAsBT,GAElB3B,EAAI,GAAKC,EAAI,GAEfyB,KAAKW,OAAOvC,EAAIS,EAAUT,EAAGC,GAC7B2B,KAAKY,QAAQxC,EAAIE,EAAIQ,EAAWV,EAAGC,EAAIS,EAAWT,EAAGS,EAAWV,EAAGU,EAAWT,EAAG,EAAc,KAAViC,KAAKO,IAAWP,KAAKO,IAC1Gb,KAAKY,QAAQxC,EAAIE,EAAIS,EAAWX,EAAGC,EAAIE,EAAIQ,EAAWV,EAAGU,EAAWX,EAAGW,EAAWV,EAAG,GAAIiC,KAAKO,IAAKP,KAAKO,GAAK,GAC7Gb,KAAKY,QAAQxC,EAAIY,EAAUZ,EAAGC,EAAIE,EAAIS,EAAUX,EAAGW,EAAUZ,EAAGY,EAAUX,EAAG,GAAIiC,KAAKO,GAAK,EAAG,GAC9Fb,KAAKY,QAAQxC,EAAIS,EAAUT,EAAGC,EAAIQ,EAAUR,EAAGQ,EAAUT,EAAGS,EAAUR,EAAG,EAAG,GAAIiC,KAAKO,GAAK,IAEjFvC,EAAI,GAEb0B,KAAKW,OAAOvC,EAAIS,EAAUT,EAAGC,GAC7B2B,KAAKY,QAAQxC,EAAIE,EAAIQ,EAAWV,EAAGC,EAAIS,EAAWT,EAAGS,EAAWV,EAAGU,EAAWT,EAAG,GAAIiC,KAAKO,GAAK,GAAIP,KAAKO,GAAI,GAC5Gb,KAAKY,QAAQxC,EAAIE,EAAIS,EAAWX,EAAGC,EAAIE,EAAIQ,EAAWV,EAAGU,EAAWX,EAAGW,EAAWV,EAAG,GAAIiC,KAAKO,GAAe,KAAVP,KAAKO,GAAU,GAClHb,KAAKY,QAAQxC,EAAIY,EAAUZ,EAAGC,EAAIE,EAAIS,EAAUX,EAAGW,EAAUZ,EAAGY,EAAUX,EAAG,EAAGiC,KAAKO,GAAK,EAAG,EAAG,GAChGb,KAAKY,QAAQxC,EAAIS,EAAUT,EAAGC,EAAIQ,EAAUR,EAAGQ,EAAUT,EAAGS,EAAUR,EAAG,EAAG,GAAIiC,KAAKO,GAAK,EAAG,IAEpFtC,EAAI,GAEbyB,KAAKW,OAAOvC,EAAIS,EAAUT,EAAGC,GAC7B2B,KAAKY,QAAQxC,EAAIE,EAAIQ,EAAWV,EAAGC,EAAIS,EAAWT,EAAGS,EAAWV,EAAGU,EAAWT,EAAG,EAAGiC,KAAKO,GAAK,EAAG,EAAG,GACpGb,KAAKY,QAAQxC,EAAIE,EAAIS,EAAWX,EAAGC,EAAIE,EAAIQ,EAAWV,EAAGU,EAAWX,EAAGW,EAAWV,EAAG,EAAG,GAAIiC,KAAKO,GAAK,EAAG,GACzGb,KAAKY,QAAQxC,EAAIY,EAAUZ,EAAGC,EAAIE,EAAIS,EAAUX,EAAGW,EAAUZ,EAAGY,EAAUX,EAAG,GAAIiC,KAAKO,GAAK,GAAIP,KAAKO,GAAI,GACxGb,KAAKY,QAAQxC,EAAIS,EAAUT,EAAGC,EAAIQ,EAAUR,EAAGQ,EAAUT,EAAGS,EAAUR,EAAG,GAAIiC,KAAKO,GAAe,KAAVP,KAAKO,GAAU,KAItGb,KAAKW,OAAOvC,EAAIS,EAAUT,EAAGC,GAC7B2B,KAAKY,QAAQxC,EAAIE,EAAIQ,EAAWV,EAAGC,EAAIS,EAAWT,EAAGS,EAAWV,EAAGU,EAAWT,EAAG,GAAIiC,KAAKO,GAAK,EAAG,GAClGb,KAAKY,QAAQxC,EAAIE,EAAIS,EAAWX,EAAGC,EAAIE,EAAIQ,EAAWV,EAAGU,EAAWX,EAAGW,EAAWV,EAAG,EAAG,EAAGiC,KAAKO,GAAK,GACrGb,KAAKY,QAAQxC,EAAIY,EAAUZ,EAAGC,EAAIE,EAAIS,EAAUX,EAAGW,EAAUZ,EAAGY,EAAUX,EAAG,EAAGiC,KAAKO,GAAK,EAAGP,KAAKO,IAClGb,KAAKY,QAAQxC,EAAIS,EAAUT,EAAGC,EAAIQ,EAAUR,EAAGQ,EAAUT,EAAGS,EAAUR,EAAG,EAAGiC,KAAKO,GAAc,IAAVP,KAAKO,KAI5Fb,KAAKc,YACLd,KAAKW,OAAOvC,EAAGC,EA7Cd,CA+CD,SAASoB,EAAeR,GAEtB,MAAMb,EAACA,EAACC,EAAEA,EAAC0C,EAAEA,EAACzC,EAAEA,GAAKW,EACrB,MAAO,CAACb,IAAGC,IAAG0C,IAAGzC,IAElB,CAiDD,SAASoB,EAAqBT,GAE5B,OAAQA,CAET,CAED,SAASY,EAAcZ,GAErB,MAAM+B,EAAWtB,EAAqBT,GACtC,OAAIN,OAAOC,SAASoC,GAEX,CACL5C,EAAG4C,EACH3C,EAAG2C,GAIHC,OAAOhC,KAAWA,EAEb,CACLb,EAAGsB,EAAqBT,EAAMb,GAAK,GACnCC,EAAGqB,EAAqBT,EAAMZ,GAAK,IAKhC,CACLD,EAAGe,IACHd,EAAGc,IAGN,CAyBF,CAED,SAASY,EAAsBmB,GAE7B,MAAO,qCAIT,SAA4BA,GAE1B,OAAOD,OAAOC,KAAcA,GAC1BA,aAAoBC,OAAS,SAC7BD,aAAoBE,YAAYC,yBAA2B,2BAC3DH,aAAoBE,YAAYE,kCAAoC,oCACpEJ,GAAUK,YAAYC,MACtBN,CAEH,CAb8CO,CAAmBP,MAEjE,CArODC,OAAOO,UAAUvD,YAAcA,EAC3BiD,WAAWC,2BAEbD,WAAWC,yBAAyBK,UAAUvD,YAAcA,GAG1DiD,WAAWE,oCAEbF,WAAWE,kCAAkCI,UAAUvD,YAAcA,EA0OxE,EAtPD"}