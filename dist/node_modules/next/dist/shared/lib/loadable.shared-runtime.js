import{commonjsRequire as e}from"../../../../../_virtual/_commonjsHelpers.js";import{__exports as t}from"../../../../../_virtual/loadable.shared-runtime.js";import"../../../../@swc/helpers/cjs/_interop_require_default.cjs.js";import r from"react";import"./loadable-context.shared-runtime.js";import{__exports as o}from"../../../../../_virtual/_interop_require_default.cjs.js";import{__exports as s}from"../../../../../_virtual/loadable-context.shared-runtime.js";!function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return h}});const a=o._(r),i=s;const l=[],n=[];let u=!1;function d(e){let t=e(),r={loading:!0,loaded:null,error:null};return r.promise=t.then((e=>(r.loading=!1,r.loaded=e,e))).catch((e=>{throw r.loading=!1,r.error=e,e})),r}function c(t,r){let o=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},r),s=null;function d(){if(!s){const e=new _(t,o);s={getCurrentValue:e.getCurrentValue.bind(e),subscribe:e.subscribe.bind(e),retry:e.retry.bind(e),promise:e.promise.bind(e)}}return s.promise()}if("undefined"==typeof window&&l.push(d),!u&&"undefined"!=typeof window){const t=o.webpack&&"function"==typeof e.resolveWeak?o.webpack():o.modules;t&&n.push((e=>{for(const r of t)if(e.includes(r))return d()}))}function c(e,t){!function(){d();const e=a.default.useContext(i.LoadableContext);e&&Array.isArray(o.modules)&&o.modules.forEach((t=>{e(t)}))}();const r=a.default.useSyncExternalStore(s.subscribe,s.getCurrentValue,s.getCurrentValue);return a.default.useImperativeHandle(t,(()=>({retry:s.retry})),[]),a.default.useMemo((()=>{return r.loading||r.error?a.default.createElement(o.loading,{isLoading:r.loading,pastDelay:r.pastDelay,timedOut:r.timedOut,error:r.error,retry:s.retry}):r.loaded?a.default.createElement((t=r.loaded)&&t.default?t.default:t,e):null;var t}),[e,r])}return c.preload=()=>d(),c.displayName="LoadableComponent",a.default.forwardRef(c)}class _{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};const{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout((()=>{this._update({pastDelay:!0})}),t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout((()=>{this._update({timedOut:!0})}),t.timeout))),this._res.promise.then((()=>{this._update({}),this._clearTimeouts()})).catch((e=>{this._update({}),this._clearTimeouts()})),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach((e=>e()))}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function m(e){return c(d,e)}function p(e,t){let r=[];for(;e.length;){let o=e.pop();r.push(o(t))}return Promise.all(r).then((()=>{if(e.length)return p(e,t)}))}m.preloadAll=()=>new Promise(((e,t)=>{p(l).then(e,t)})),m.preloadReady=e=>(void 0===e&&(e=[]),new Promise((t=>{const r=()=>(u=!0,t());p(n,e).then(r,r)}))),"undefined"!=typeof window&&(window.__NEXT_PRELOADREADY=m.preloadReady);const h=m}(t);
//# sourceMappingURL=loadable.shared-runtime.js.map
