{"version":3,"file":"LexicalAutoEmbedPlugin.prod.mjs.js","sources":["../../../../node_modules/@lexical/react/LexicalAutoEmbedPlugin.prod.mjs"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{$isLinkNode as e,LinkNode as t,AutoLinkNode as n}from\"@lexical/link\";import{useLexicalComposerContext as o}from\"@lexical/react/LexicalComposerContext\";import{MenuOption as r,LexicalNodeMenuPlugin as i}from\"@lexical/react/LexicalNodeMenuPlugin\";import{mergeRegister as l}from\"@lexical/utils\";import{createCommand as s,$getNodeByKey as a,COMMAND_PRIORITY_EDITOR as c,$getSelection as u,COMMAND_PRIORITY_LOW as m}from\"lexical\";import{useState as d,useCallback as p,useEffect as f,useMemo as x}from\"react\";import{jsx as g}from\"react/jsx-runtime\";const w=/((https?:\\/\\/(www\\.)?)|(www\\.))[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/,C=s(\"INSERT_EMBED_COMMAND\");class y extends r{constructor(e,t){super(e),this.title=e,this.onSelect=t.onSelect.bind(this)}}function E({embedConfigs:r,onOpenEmbedModalForConfig:s,getMenuOptions:w,menuRenderFn:y,menuCommandPriority:E=m}){const[M]=o(),[S,h]=d(null),[_,v]=d(null),z=p((()=>{h(null),v(null)}),[]),A=p((async t=>{const n=M.getEditorState().read((function(){const n=a(t);if(e(n))return n.getURL()}));if(void 0!==n)for(const e of r){null!=await Promise.resolve(e.parseUrl(n))&&(v(e),h(t))}}),[M,r]);f((()=>l(...[t,n].map((e=>M.registerMutationListener(e,((...e)=>((e,{updateTags:t,dirtyLeaves:n})=>{for(const[o,r]of e)\"created\"===r&&t.has(\"paste\")&&n.size<=3?A(o):o===S&&z()})(...e)),{skipInitialization:!0}))))),[A,M,r,S,z]),f((()=>M.registerCommand(C,(e=>{const t=r.find((({type:t})=>t===e));return!!t&&(s(t),!0)}),c)),[M,r,s]);const L=p((async function(){if(null!=_&&null!=S){const t=M.getEditorState().read((()=>{const t=a(S);return e(t)?t:null}));if(e(t)){const e=await Promise.resolve(_.parseUrl(t.__url));null!=e&&M.update((()=>{u()||t.selectEnd(),_.insertNode(M,e),t.isAttached()&&t.remove()}))}}}),[_,M,S]),P=x((()=>null!=_&&null!=S?w(_,L,z):[]),[_,L,w,S,z]),b=p(((e,t,n)=>{M.update((()=>{e.onSelect(t),n()}))}),[M]);return null!=S?g(i,{nodeKey:S,onClose:z,onSelectOption:b,options:P,menuRenderFn:y,commandPriority:E}):null}export{y as AutoEmbedOption,C as INSERT_EMBED_COMMAND,E as LexicalAutoEmbedPlugin,w as URL_MATCHER};\n"],"names":["w","C","s","y","r","constructor","e","t","super","this","title","onSelect","bind","E","embedConfigs","onOpenEmbedModalForConfig","getMenuOptions","menuRenderFn","menuCommandPriority","m","M","o","S","h","d","_","v","z","p","A","async","n","getEditorState","read","a","getURL","Promise","resolve","parseUrl","f","l","map","registerMutationListener","updateTags","dirtyLeaves","has","size","skipInitialization","registerCommand","find","type","c","L","__url","update","u","selectEnd","insertNode","isAttached","remove","P","x","b","g","i","nodeKey","onClose","onSelectOption","options","commandPriority"],"mappings":"ykBAQ0iB,MAACA,EAAE,kHAAkHC,EAAEC,EAAE,wBAAwB,MAAMC,UAAUC,EAAE,WAAAC,CAAYC,EAAEC,GAAGC,MAAMF,GAAGG,KAAKC,MAAMJ,EAAEG,KAAKE,SAASJ,EAAEI,SAASC,KAAKH,KAAK,EAAE,SAASI,GAAGC,aAAaV,EAAEW,0BAA0Bb,EAAEc,eAAehB,EAAEiB,aAAad,EAAEe,oBAAoBL,EAAEM,IAAI,MAAMC,GAAGC,KAAKC,EAAEC,GAAGC,EAAE,OAAOC,EAAEC,GAAGF,EAAE,MAAMG,EAAEC,GAAG,KAAKL,EAAE,MAAMG,EAAE,KAAM,GAAE,IAAIG,EAAED,GAAC,MAAEE,IAAU,MAAMC,EAAEX,EAAEY,iBAAiBC,MAAM,WAAW,MAAMF,EAAEG,EAAE3B,GAAG,GAAGD,EAAEyB,GAAG,OAAOA,EAAEI,QAAS,IAAG,QAAG,IAASJ,EAAE,IAAI,MAAMzB,KAAKF,EAAG,YAAYgC,QAAQC,QAAQ/B,EAAEgC,SAASP,MAAML,EAAEpB,GAAGiB,EAAEhB,GAAK,GAAE,CAACa,EAAEhB,IAAImC,OAAOC,KAAK,CAACjC,EAAEwB,GAAGU,KAAKnC,GAAGc,EAAEsB,yBAAyBpC,GAAG,IAAIA,IAAI,EAAEA,GAAGqC,WAAWpC,EAAEqC,YAAYb,MAAM,IAAI,MAAMV,EAAEjB,KAAKE,EAAE,YAAYF,GAAGG,EAAEsC,IAAI,UAAUd,EAAEe,MAAM,EAAEjB,EAAER,GAAGA,IAAIC,GAAGK,GAAI,EAAhH,IAAqHrB,IAAI,CAACyC,oBAAmB,QAAS,CAAClB,EAAET,EAAEhB,EAAEkB,EAAEK,IAAIY,GAAG,IAAInB,EAAE4B,gBAAgB/C,GAAGK,IAAI,MAAMC,EAAEH,EAAE6C,MAAI,EAAIC,KAAK3C,KAAKA,IAAID,IAAI,QAAQC,IAAIL,EAAEK,IAAG,EAAI,GAAE4C,IAAI,CAAC/B,EAAEhB,EAAEF,IAAI,MAAMkD,EAAExB,GAAC,iBAAmB,GAAG,MAAMH,GAAG,MAAMH,EAAE,CAAC,MAAMf,EAAEa,EAAEY,iBAAiBC,MAAI,KAAO,MAAM1B,EAAE2B,EAAEZ,GAAG,OAAOhB,EAAEC,GAAGA,EAAE,IAAK,IAAG,GAAGD,EAAEC,GAAG,CAAC,MAAMD,QAAQ8B,QAAQC,QAAQZ,EAAEa,SAAS/B,EAAE8C,QAAQ,MAAM/C,GAAGc,EAAEkC,QAAQ,KAAKC,KAAKhD,EAAEiD,YAAY/B,EAAEgC,WAAWrC,EAAEd,GAAGC,EAAEmD,cAAcnD,EAAEoD,QAAS,GAAE,CAAC,CAAE,GAAE,CAAClC,EAAEL,EAAEE,IAAIsC,EAAEC,GAAG,IAAI,MAAMpC,GAAG,MAAMH,EAAEtB,EAAEyB,EAAE2B,EAAEzB,GAAG,IAAI,CAACF,EAAE2B,EAAEpD,EAAEsB,EAAEK,IAAImC,EAAElC,GAAG,CAACtB,EAAEC,EAAEwB,KAAKX,EAAEkC,QAAQ,KAAKhD,EAAEK,SAASJ,GAAGwB,GAAI,GAAG,GAAE,CAACX,IAAI,OAAO,MAAME,EAAEyC,cAAEC,EAAE,CAACC,QAAQ3C,EAAE4C,QAAQvC,EAAEwC,eAAeL,EAAEM,QAAQR,EAAE3C,aAAad,EAAEkE,gBAAgBxD,IAAI,IAAI"}