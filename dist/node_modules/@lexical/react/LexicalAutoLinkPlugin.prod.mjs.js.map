{"version":3,"file":"LexicalAutoLinkPlugin.prod.mjs.js","sources":["../../../../node_modules/@lexical/react/LexicalAutoLinkPlugin.prod.mjs"],"sourcesContent":["/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\n\nimport{AutoLinkNode as t,$isAutoLinkNode as e,$isLinkNode as n,TOGGLE_LINK_COMMAND as r,$createAutoLinkNode as l}from\"@lexical/link\";import{useLexicalComposerContext as i}from\"@lexical/react/LexicalComposerContext\";import{mergeRegister as o}from\"@lexical/utils\";import{TextNode as s,$getSelection as u,$isRangeSelection as g,COMMAND_PRIORITY_LOW as c,$isTextNode as a,$isElementNode as f,$isLineBreakNode as x,$createTextNode as h,$isNodeSelection as p}from\"lexical\";import{useEffect as d}from\"react\";function m(t,e=(t=>t)){return n=>{const r=t.exec(n);return null===r?null:{index:r.index,length:r[0].length,text:r[0],url:e(r[0])}}}function T(t,e){for(let n=0;n<e.length;n++){const r=e[n](t);if(r)return r}return null}const C=/[.,;\\s]/;function S(t){return C.test(t)}function b(t){return S(t[t.length-1])}function U(t){return S(t[0])}function v(t){let e=t.getPreviousSibling();return f(e)&&(e=e.getLastDescendant()),null===e||x(e)||a(e)&&b(e.getTextContent())}function L(t){let e=t.getNextSibling();return f(e)&&(e=e.getFirstDescendant()),null===e||x(e)||a(e)&&U(e.getTextContent())}function R(t,e,n,r){if(!(t>0?S(n[t-1]):v(r[0])))return!1;return e<n.length?S(n[e]):L(r[r.length-1])}function k(t,e,n){const r=[],l=[],i=[];let o=0,s=0;const u=[...t];for(;u.length>0;){const t=u[0],g=t.getTextContent().length,c=s;s+g<=e?(r.push(t),o+=g):c>=n?i.push(t):l.push(t),s+=g,u.shift()}return[o,r,l,i]}function D(t,e,n,r){const i=l(r.url,r.attributes);if(1===t.length){let l,o=t[0];0===e?[l,o]=o.splitText(n):[,l,o]=o.splitText(e,n);const s=h(r.text);return s.setFormat(l.getFormat()),s.setDetail(l.getDetail()),s.setStyle(l.getStyle()),i.append(s),l.replace(i),o}if(t.length>1){const r=t[0];let l,o=r.getTextContent().length;0===e?l=r:[,l]=r.splitText(e);const s=[];let c;for(let e=1;e<t.length;e++){const r=t[e],l=r.getTextContent().length,i=o;if(i<n)if(o+l<=n)s.push(r);else{const[t,e]=r.splitText(n-i);s.push(t),c=e}o+=l}const f=u(),x=f?f.getNodes().find(a):void 0,d=h(l.getTextContent());return d.setFormat(l.getFormat()),d.setDetail(l.getDetail()),d.setStyle(l.getStyle()),i.append(d,...s),x&&x===l&&(g(f)?d.select(f.anchor.offset,f.focus.offset):p(f)&&d.select(0,d.getTextContent().length)),l.replace(i),c}}function N(t,e,n){const r=t.getChildren(),l=r.length;for(let e=0;e<l;e++){const l=r[e];if(!a(l)||!l.isSimpleText())return I(t),void n(null,t.getURL())}const i=t.getTextContent(),o=T(i,e);if(null===o||o.text!==i)return I(t),void n(null,t.getURL());if(!v(t)||!L(t))return I(t),void n(null,t.getURL());const s=t.getURL();if(s!==o.url&&(t.setURL(o.url),n(o.url,s)),o.attributes){const e=t.getRel();e!==o.attributes.rel&&(t.setRel(o.attributes.rel||null),n(o.attributes.rel||null,e));const r=t.getTarget();r!==o.attributes.target&&(t.setTarget(o.attributes.target||null),n(o.attributes.target||null,r))}}function I(t){const e=t.getChildren();for(let n=e.length-1;n>=0;n--)t.insertAfter(e[n]);return t.remove(),e.map((t=>t.getLatest()))}function P(l,i,f){d((()=>{l.hasNodes([t])||function(t,...e){const n=new URL(\"https://lexical.dev/docs/error\"),r=new URLSearchParams;r.append(\"code\",t);for(const t of e)r.append(\"v\",t);throw n.search=r.toString(),Error(`Minified Lexical error #${t}; visit ${n.toString()} for the full message or use the non-minified dev environment for full errors and additional helpful warnings.`)}(77);const x=(t,e)=>{f&&f(t,e)};return o(l.registerNodeTransform(s,(t=>{const r=t.getParentOrThrow(),l=t.getPreviousSibling();if(e(r)&&!r.getIsUnlinked())N(r,i,x);else if(!n(r)){if(t.isSimpleText()&&(U(t.getTextContent())||!e(l))){const e=function(t){const e=[t];let n=t.getNextSibling();for(;null!==n&&a(n)&&n.isSimpleText()&&(e.push(n),!/[\\s]/.test(n.getTextContent()));)n=n.getNextSibling();return e}(t);!function(t,e,n){let r=[...t];const l=r.map((t=>t.getTextContent())).join(\"\");let i,o=l,s=0;for(;(i=T(o,e))&&null!==i;){const t=i.index,e=t+i.length;if(R(s+t,s+e,l,r)){const[l,,o,u]=k(r,s+t,s+e),g=D(o,s+t-l,s+e-l,i);r=g?[g,...u]:u,n(i.url,null),s=0}else s+=e;o=o.substring(e)}}(e,i,x)}!function(t,n,r){const l=t.getPreviousSibling(),i=t.getNextSibling(),o=t.getTextContent();var s;!e(l)||l.getIsUnlinked()||U(o)&&(s=o,!(l.isEmailURI()?/^\\.[a-zA-Z]{2,}/.test(s):/^\\.[a-zA-Z0-9]{1,}/.test(s)))||(l.append(t),N(l,n,r),r(null,l.getURL())),!e(i)||i.getIsUnlinked()||b(o)||(I(i),N(i,n,r),r(null,i.getURL()))}(t,i,x)}})),l.registerCommand(r,(t=>{const n=u();if(null!==t||!g(n))return!1;return n.extract().forEach((t=>{const n=t.getParent();if(e(n))return n.setIsUnlinked(!n.getIsUnlinked()),n.markDirty(),!0})),!1}),c))}),[l,i,f])}function w({matchers:t,onChange:e}){const[n]=i();return P(n,t,e),null}export{w as AutoLinkPlugin,m as createLinkMatcherWithRegExp};\n"],"names":["m","t","e","n","r","exec","index","length","text","url","T","C","S","test","b","U","v","getPreviousSibling","f","getLastDescendant","x","a","getTextContent","L","getNextSibling","getFirstDescendant","R","k","l","i","o","s","u","g","c","push","shift","D","attributes","splitText","h","setFormat","getFormat","setDetail","getDetail","setStyle","getStyle","append","replace","getNodes","find","d","select","anchor","offset","focus","p","N","getChildren","isSimpleText","I","getURL","setURL","getRel","rel","setRel","getTarget","target","setTarget","insertAfter","remove","map","getLatest","w","matchers","onChange","hasNodes","URL","URLSearchParams","search","toString","Error","registerNodeTransform","getParentOrThrow","getIsUnlinked","join","substring","isEmailURI","registerCommand","extract","forEach","getParent","setIsUnlinked","markDirty"],"mappings":"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"}