import n from"./constant.js";import{pi as t,cos as r,sin as c,halfPi as e,epsilon as o,tau as u,sqrt as i,min as y,abs as a,atan2 as l,asin as f,acos as p,max as x}from"./math.js";import{withPath as s}from"./path.js";function h(n){return n.innerRadius}function v(n){return n.outerRadius}function g(n){return n.startAngle}function d(n){return n.endAngle}function m(n){return n&&n.padAngle}function T(n,t,r,c,e,o,u){var y=n-r,a=t-c,l=(u?o:-o)/i(y*y+a*a),f=l*a,p=-l*y,s=n+f,h=t+p,v=r+f,g=c+p,d=(s+v)/2,m=(h+g)/2,T=v-s,A=g-h,R=T*T+A*A,j=e-o,P=s*g-v*h,b=(A<0?-1:1)*i(x(0,j*j*R-P*P)),k=(P*A-T*b)/R,q=(-P*T-A*b)/R,w=(P*A+T*b)/R,z=(-P*T+A*b)/R,B=k-d,C=q-m,D=w-d,E=z-m;return B*B+C*C>D*D+E*E&&(k=w,q=z),{cx:k,cy:q,x01:-f,y01:-p,x11:k*(e/j-1),y11:q*(e/j-1)}}function A(){var x=h,A=v,R=n(0),j=null,P=g,b=d,k=m,q=null,w=s(z);function z(){var n,s,h=+x.apply(this,arguments),v=+A.apply(this,arguments),g=P.apply(this,arguments)-e,d=b.apply(this,arguments)-e,m=a(d-g),z=d>g;if(q||(q=n=w()),v<h&&(s=v,v=h,h=s),v>o)if(m>u-o)q.moveTo(v*r(g),v*c(g)),q.arc(0,0,v,g,d,!z),h>o&&(q.moveTo(h*r(d),h*c(d)),q.arc(0,0,h,d,g,z));else{var B,C,D=g,E=d,F=g,G=d,H=m,I=m,J=k.apply(this,arguments)/2,K=J>o&&(j?+j.apply(this,arguments):i(h*h+v*v)),L=y(a(v-h)/2,+R.apply(this,arguments)),M=L,N=L;if(K>o){var O=f(K/h*c(J)),Q=f(K/v*c(J));(H-=2*O)>o?(F+=O*=z?1:-1,G-=O):(H=0,F=G=(g+d)/2),(I-=2*Q)>o?(D+=Q*=z?1:-1,E-=Q):(I=0,D=E=(g+d)/2)}var S=v*r(D),U=v*c(D),V=h*r(G),W=h*c(G);if(L>o){var X,Y=v*r(E),Z=v*c(E),$=h*r(F),_=h*c(F);if(m<t)if(X=function(n,t,r,c,e,u,i,y){var a=r-n,l=c-t,f=i-e,p=y-u,x=p*a-f*l;if(!(x*x<o))return[n+(x=(f*(t-u)-p*(n-e))/x)*a,t+x*l]}(S,U,$,_,Y,Z,V,W)){var nn=S-X[0],tn=U-X[1],rn=Y-X[0],cn=Z-X[1],en=1/c(p((nn*rn+tn*cn)/(i(nn*nn+tn*tn)*i(rn*rn+cn*cn)))/2),on=i(X[0]*X[0]+X[1]*X[1]);M=y(L,(h-on)/(en-1)),N=y(L,(v-on)/(en+1))}else M=N=0}I>o?N>o?(B=T($,_,S,U,v,N,z),C=T(Y,Z,V,W,v,N,z),q.moveTo(B.cx+B.x01,B.cy+B.y01),N<L?q.arc(B.cx,B.cy,N,l(B.y01,B.x01),l(C.y01,C.x01),!z):(q.arc(B.cx,B.cy,N,l(B.y01,B.x01),l(B.y11,B.x11),!z),q.arc(0,0,v,l(B.cy+B.y11,B.cx+B.x11),l(C.cy+C.y11,C.cx+C.x11),!z),q.arc(C.cx,C.cy,N,l(C.y11,C.x11),l(C.y01,C.x01),!z))):(q.moveTo(S,U),q.arc(0,0,v,D,E,!z)):q.moveTo(S,U),h>o&&H>o?M>o?(B=T(V,W,Y,Z,h,-M,z),C=T(S,U,$,_,h,-M,z),q.lineTo(B.cx+B.x01,B.cy+B.y01),M<L?q.arc(B.cx,B.cy,M,l(B.y01,B.x01),l(C.y01,C.x01),!z):(q.arc(B.cx,B.cy,M,l(B.y01,B.x01),l(B.y11,B.x11),!z),q.arc(0,0,h,l(B.cy+B.y11,B.cx+B.x11),l(C.cy+C.y11,C.cx+C.x11),z),q.arc(C.cx,C.cy,M,l(C.y11,C.x11),l(C.y01,C.x01),!z))):q.arc(0,0,h,G,F,z):q.lineTo(V,W)}else q.moveTo(0,0);if(q.closePath(),n)return q=null,n+""||null}return z.centroid=function(){var n=(+x.apply(this,arguments)+ +A.apply(this,arguments))/2,e=(+P.apply(this,arguments)+ +b.apply(this,arguments))/2-t/2;return[r(e)*n,c(e)*n]},z.innerRadius=function(t){return arguments.length?(x="function"==typeof t?t:n(+t),z):x},z.outerRadius=function(t){return arguments.length?(A="function"==typeof t?t:n(+t),z):A},z.cornerRadius=function(t){return arguments.length?(R="function"==typeof t?t:n(+t),z):R},z.padRadius=function(t){return arguments.length?(j=null==t?null:"function"==typeof t?t:n(+t),z):j},z.startAngle=function(t){return arguments.length?(P="function"==typeof t?t:n(+t),z):P},z.endAngle=function(t){return arguments.length?(b="function"==typeof t?t:n(+t),z):b},z.padAngle=function(t){return arguments.length?(k="function"==typeof t?t:n(+t),z):k},z.context=function(n){return arguments.length?(q=null==n?null:n,z):q},z}export{A as default};
//# sourceMappingURL=arc.js.map
