import t from"../../../d3-dispatch/src/dispatch.js";import{timer as e}from"../../../d3-timer/src/timer.js";import r from"../../../d3-timer/src/timeout.js";var a=t("start","end","cancel","interrupt"),n=[],i=0,o=1,s=2,l=3,d=4,u=5,_=6;function f(t,i,o,s,l,d){var u=t.__transition;if(u){if(o in u)return}else t.__transition={};!function(t,a,n){var i,o=t.__transition;function s(t){n.state=1,n.timer.restart(l,n.delay,n.time),n.delay<=t&&l(t-n.delay)}function l(e){var s,_,f,c;if(1!==n.state)return u();for(s in o)if((c=o[s]).name===n.name){if(3===c.state)return r(l);4===c.state?(c.state=6,c.timer.stop(),c.on.call("interrupt",t,t.__data__,c.index,c.group),delete o[s]):+s<a&&(c.state=6,c.timer.stop(),c.on.call("cancel",t,t.__data__,c.index,c.group),delete o[s])}if(r((function(){3===n.state&&(n.state=4,n.timer.restart(d,n.delay,n.time),d(e))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=3,i=new Array(f=n.tween.length),s=0,_=-1;s<f;++s)(c=n.tween[s].value.call(t,t.__data__,n.index,n.group))&&(i[++_]=c);i.length=_+1}}function d(e){for(var r=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(u),n.state=5,1),a=-1,o=i.length;++a<o;)i[a].call(t,r);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),u())}function u(){for(var e in n.state=6,n.timer.stop(),delete o[a],o)return;delete t.__transition}o[a]=n,n.timer=e(s,0,n.time)}(t,o,{name:i,index:s,group:l,on:a,tween:n,time:d.time,delay:d.delay,duration:d.duration,ease:d.ease,timer:null,state:0})}function c(t,e){var r=p(t,e);if(r.state>0)throw new Error("too late; already scheduled");return r}function m(t,e){var r=p(t,e);if(r.state>3)throw new Error("too late; already running");return r}function p(t,e){var r=t.__transition;if(!r||!(r=r[e]))throw new Error("transition not found");return r}export{i as CREATED,_ as ENDED,u as ENDING,d as RUNNING,o as SCHEDULED,l as STARTED,s as STARTING,f as default,p as get,c as init,m as set};
//# sourceMappingURL=schedule.js.map
