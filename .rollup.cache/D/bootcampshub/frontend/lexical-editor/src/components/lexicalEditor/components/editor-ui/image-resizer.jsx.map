{"version":3,"file":"image-resizer.jsx","sourceRoot":"","sources":["image-resizer.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react'\nimport { useRef, JSX } from 'react'\n\nimport { calculateZoomLevel } from '@lexical/utils'\nimport type { LexicalEditor } from 'lexical'\n\nimport { Button } from '../../ui/button'\n\nfunction clamp(value: number, min: number, max: number) {\n  return Math.min(Math.max(value, min), max)\n}\n\nconst Direction = {\n  east: 1 << 0,\n  north: 1 << 3,\n  south: 1 << 1,\n  west: 1 << 2,\n}\n\nexport function ImageResizer({\n  onResizeStart,\n  onResizeEnd,\n  buttonRef,\n  imageRef,\n  maxWidth,\n  editor,\n  showCaption,\n  setShowCaption,\n  captionsEnabled,\n}: {\n  editor: LexicalEditor\n  buttonRef: { current: null | HTMLButtonElement }\n  imageRef: { current: null | HTMLElement }\n  maxWidth?: number\n  onResizeEnd: (width: 'inherit' | number, height: 'inherit' | number) => void\n  onResizeStart: () => void\n  setShowCaption: (show: boolean) => void\n  showCaption: boolean\n  captionsEnabled: boolean\n}): JSX.Element {\n  const controlWrapperRef = useRef<HTMLDivElement>(null)\n  const userSelect = useRef({\n    priority: '',\n    value: 'default',\n  })\n  const positioningRef = useRef<{\n    currentHeight: 'inherit' | number\n    currentWidth: 'inherit' | number\n    direction: number\n    isResizing: boolean\n    ratio: number\n    startHeight: number\n    startWidth: number\n    startX: number\n    startY: number\n  }>({\n    currentHeight: 0,\n    currentWidth: 0,\n    direction: 0,\n    isResizing: false,\n    ratio: 0,\n    startHeight: 0,\n    startWidth: 0,\n    startX: 0,\n    startY: 0,\n  })\n  const editorRootElement = editor.getRootElement()\n  // Find max width, accounting for editor padding.\n  const maxWidthContainer = maxWidth\n    ? maxWidth\n    : editorRootElement !== null\n      ? editorRootElement.getBoundingClientRect().width - 20\n      : 100\n  const maxHeightContainer =\n    editorRootElement !== null\n      ? editorRootElement.getBoundingClientRect().height - 20\n      : 100\n\n  const minWidth = 100\n  const minHeight = 100\n\n  const setStartCursor = (direction: number) => {\n    const ew = direction === Direction.east || direction === Direction.west\n    const ns = direction === Direction.north || direction === Direction.south\n    const nwse =\n      (direction & Direction.north && direction & Direction.west) ||\n      (direction & Direction.south && direction & Direction.east)\n\n    const cursorDir = ew ? 'ew' : ns ? 'ns' : nwse ? 'nwse' : 'nesw'\n\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important'\n      )\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty(\n        'cursor',\n        `${cursorDir}-resize`,\n        'important'\n      )\n      userSelect.current.value = document.body.style.getPropertyValue(\n        '-webkit-user-select'\n      )\n      userSelect.current.priority = document.body.style.getPropertyPriority(\n        '-webkit-user-select'\n      )\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        `none`,\n        'important'\n      )\n    }\n  }\n\n  const setEndCursor = () => {\n    if (editorRootElement !== null) {\n      editorRootElement.style.setProperty('cursor', 'text')\n    }\n    if (document.body !== null) {\n      document.body.style.setProperty('cursor', 'default')\n      document.body.style.setProperty(\n        '-webkit-user-select',\n        userSelect.current.value,\n        userSelect.current.priority\n      )\n    }\n  }\n\n  const handlePointerDown = (\n    event: React.PointerEvent<HTMLDivElement>,\n    direction: number\n  ) => {\n    if (!editor.isEditable()) {\n      return\n    }\n\n    const image = imageRef.current\n    const controlWrapper = controlWrapperRef.current\n\n    if (image !== null && controlWrapper !== null) {\n      event.preventDefault()\n      const { width, height } = image.getBoundingClientRect()\n      const zoom = calculateZoomLevel(image)\n      const positioning = positioningRef.current\n      positioning.startWidth = width\n      positioning.startHeight = height\n      positioning.ratio = width / height\n      positioning.currentWidth = width\n      positioning.currentHeight = height\n      positioning.startX = event.clientX / zoom\n      positioning.startY = event.clientY / zoom\n      positioning.isResizing = true\n      positioning.direction = direction\n\n      setStartCursor(direction)\n      onResizeStart()\n\n      controlWrapper.classList.add('touch-action-none')\n      image.style.height = `${height}px`\n      image.style.width = `${width}px`\n\n      document.addEventListener('pointermove', handlePointerMove)\n      document.addEventListener('pointerup', handlePointerUp)\n    }\n  }\n  const handlePointerMove = (event: PointerEvent) => {\n    const image = imageRef.current\n    const positioning = positioningRef.current\n\n    const isHorizontal =\n      positioning.direction & (Direction.east | Direction.west)\n    const isVertical =\n      positioning.direction & (Direction.south | Direction.north)\n\n    if (image !== null && positioning.isResizing) {\n      const zoom = calculateZoomLevel(image)\n      // Corner cursor\n      if (isHorizontal && isVertical) {\n        let diff = Math.floor(positioning.startX - event.clientX / zoom)\n        diff = positioning.direction & Direction.east ? -diff : diff\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer\n        )\n\n        const height = width / positioning.ratio\n        image.style.width = `${width}px`\n        image.style.height = `${height}px`\n        positioning.currentHeight = height\n        positioning.currentWidth = width\n      } else if (isVertical) {\n        let diff = Math.floor(positioning.startY - event.clientY / zoom)\n        diff = positioning.direction & Direction.south ? -diff : diff\n\n        const height = clamp(\n          positioning.startHeight + diff,\n          minHeight,\n          maxHeightContainer\n        )\n\n        image.style.height = `${height}px`\n        positioning.currentHeight = height\n      } else {\n        let diff = Math.floor(positioning.startX - event.clientX / zoom)\n        diff = positioning.direction & Direction.east ? -diff : diff\n\n        const width = clamp(\n          positioning.startWidth + diff,\n          minWidth,\n          maxWidthContainer\n        )\n\n        image.style.width = `${width}px`\n        positioning.currentWidth = width\n      }\n    }\n  }\n  const handlePointerUp = () => {\n    const image = imageRef.current\n    const positioning = positioningRef.current\n    const controlWrapper = controlWrapperRef.current\n    if (image !== null && controlWrapper !== null && positioning.isResizing) {\n      const width = positioning.currentWidth\n      const height = positioning.currentHeight\n      positioning.startWidth = 0\n      positioning.startHeight = 0\n      positioning.ratio = 0\n      positioning.startX = 0\n      positioning.startY = 0\n      positioning.currentWidth = 0\n      positioning.currentHeight = 0\n      positioning.isResizing = false\n\n      controlWrapper.classList.remove('touch-action-none')\n\n      setEndCursor()\n      onResizeEnd(width, height)\n\n      document.removeEventListener('pointermove', handlePointerMove)\n      document.removeEventListener('pointerup', handlePointerUp)\n    }\n  }\n  return (\n    <div ref={controlWrapperRef}>\n      {!showCaption && captionsEnabled && (\n        <Button\n          className=\"image-caption-button absolute bottom-1 left-1/2 -translate-x-1/2\"\n          ref={buttonRef}\n          variant={'outline'}\n          onClick={() => {\n            setShowCaption(!showCaption)\n          }}\n        >\n          Add Caption\n        </Button>\n      )}\n      <div\n        className=\"image-resizer image-resizer-n absolute -top-2.5 left-1/2 h-3 w-3 -translate-x-1/2 cursor-ns-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-ne absolute -right-2.5 -top-2.5 h-3 w-3 cursor-nesw-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.east)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-e absolute -right-2.5 top-1/2 h-3 w-3 -translate-y-1/2 cursor-ew-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.east)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-se absolute -bottom-2.5 -right-2.5 h-3 w-3 cursor-nwse-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.east)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-s absolute -bottom-2.5 left-1/2 h-3 w-3 -translate-x-1/2 cursor-ns-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-sw absolute -bottom-2.5 -left-2.5 h-3 w-3 cursor-nesw-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.south | Direction.west)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-w absolute -left-2.5 top-1/2 h-3 w-3 -translate-y-1/2 cursor-ew-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.west)\n        }}\n      />\n      <div\n        className=\"image-resizer image-resizer-nw absolute -left-2.5 -top-2.5 h-3 w-3 cursor-nwse-resize bg-primary\"\n        onPointerDown={(event) => {\n          handlePointerDown(event, Direction.north | Direction.west)\n        }}\n      />\n    </div>\n  )\n}\n"]}