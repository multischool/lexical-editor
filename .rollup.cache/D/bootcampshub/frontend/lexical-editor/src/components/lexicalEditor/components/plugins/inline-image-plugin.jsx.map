{"version":3,"file":"inline-image-plugin.jsx","sourceRoot":"","sources":["inline-image-plugin.tsx"],"names":[],"mappings":"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","sourcesContent":["'use client'\n\n/**\n * Copyright (c) Meta Platforms, Inc. and affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n *\n */\nimport * as React from 'react'\nimport { useEffect, useRef, useState, JSX } from 'react'\n\n// import '../nodes/inline-image-node.css';\nimport { useLexicalComposerContext } from '@lexical/react/LexicalComposerContext'\nimport { $wrapNodeInElement, mergeRegister } from '@lexical/utils'\nimport {\n  $createParagraphNode,\n  $createRangeSelection,\n  $getSelection,\n  $insertNodes,\n  $isNodeSelection,\n  $isRootOrShadowRoot,\n  $setSelection,\n  COMMAND_PRIORITY_EDITOR,\n  COMMAND_PRIORITY_HIGH,\n  COMMAND_PRIORITY_LOW,\n  DRAGOVER_COMMAND,\n  DRAGSTART_COMMAND,\n  DROP_COMMAND,\n  LexicalCommand,\n  LexicalEditor,\n  createCommand,\n} from 'lexical'\n\nimport { Button } from '../../ui/button'\nimport { Checkbox } from '../../ui/checkbox'\nimport { Input } from '../../ui/input'\nimport { Label } from '../../ui/label'\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '../../ui/select'\n\nimport type { Position } from '../nodes/inline-image-node'\nimport {\n  $createInlineImageNode,\n  $isInlineImageNode,\n  InlineImageNode,\n  InlineImagePayload,\n} from '../nodes/inline-image-node'\nimport { CAN_USE_DOM } from '../shared/can-use-dom'\n\nexport type InsertInlineImagePayload = Readonly<InlineImagePayload>\n\nconst getDOMSelection = (targetWindow: Window | null): Selection | null =>\n  CAN_USE_DOM ? (targetWindow || window).getSelection() : null\n\nexport const INSERT_INLINE_IMAGE_COMMAND: LexicalCommand<InlineImagePayload> =\n  createCommand('INSERT_INLINE_IMAGE_COMMAND')\n\n/**\n * Default image upload handler that sends to the server\n * @param file The image file to upload\n * @returns Promise resolving to the URL of the uploaded image\n */\nasync function defaultUploadImageToServer(file: File): Promise<string> {\n  try {\n    // Create a FormData instance to send the file\n    const formData = new FormData();\n    formData.append('image', file);\n    \n    // Make the API request to your server endpoint\n    const response = await fetch('/api/upload-image', {\n      method: 'POST',\n      body: formData,\n    });\n    \n    if (!response.ok) {\n      throw new Error(`Upload failed with status: ${response.status}`);\n    }\n    \n    const data = await response.json();\n    \n    // Return the URL of the uploaded image from the server response\n    return data.imageUrl;\n  } catch (error) {\n    console.error('Error uploading image:', error);\n    throw error;\n  }\n}\n\nexport function InsertInlineImageDialog({\n  activeEditor,\n  onClose,\n  onImageUpload,\n}: {\n  activeEditor: LexicalEditor\n  onClose: () => void\n  onImageUpload?: (file: File) => Promise<{ url: string }>;\n}): JSX.Element {\n  const hasModifier = useRef(false)\n\n  const [src, setSrc] = useState('')\n  const [altText, setAltText] = useState('')\n  const [showCaption, setShowCaption] = useState(false)\n  const [position, setPosition] = useState<Position>('left')\n  const [file, setFile] = useState<File | null>(null)\n  const [isUploading, setIsUploading] = useState(false)\n  const [uploadError, setUploadError] = useState<string | null>(null)\n  const [previewSrc, setPreviewSrc] = useState<string>('')\n\n  const isDisabled = !file || isUploading\n\n  const handleFileChange = (files: FileList | null) => {\n    if (files && files.length > 0) {\n      setFile(files[0])\n      setUploadError(null)\n      \n      // Generate preview\n      const reader = new FileReader()\n      reader.onload = function () {\n        if (typeof reader.result === 'string') {\n          setPreviewSrc(reader.result)\n          \n          // Set default alt text based on filename\n          if (!altText) {\n            const fileName = files[0].name;\n            // Remove file extension and convert dashes/underscores to spaces\n            const nameWithoutExtension = fileName.split('.').slice(0, -1).join('.');\n            const formattedName = nameWithoutExtension.replace(/[-_]/g, ' ');\n            setAltText(formattedName);\n          }\n        }\n      }\n      reader.readAsDataURL(files[0])\n    }\n  }\n\n  useEffect(() => {\n    hasModifier.current = false\n    const handler = (e: KeyboardEvent) => {\n      hasModifier.current = e.altKey\n    }\n    document.addEventListener('keydown', handler)\n    return () => {\n      document.removeEventListener('keydown', handler)\n    }\n  }, [activeEditor])\n\n  const handleOnClick = async () => {\n    if (!file) return\n    \n    setIsUploading(true)\n    setUploadError(null)\n    \n    try {\n      let serverImageUrl: string;\n      \n      // Check if onImageUpload is provided\n      if (!onImageUpload) {\n        // Fall back to default upload handler if available\n        try {\n          serverImageUrl = await defaultUploadImageToServer(file);\n        } catch (uploadError) {\n          setUploadError(\"Failed to upload image using default handler. Please try again.\");\n          console.error('Default upload error:', uploadError);\n          setIsUploading(false);\n          return;\n        }\n      } else {\n        // Use the provided custom upload handler\n        const result = await onImageUpload(file);\n        serverImageUrl = result.url;\n      }\n      \n      // Update the src with the server URL\n      setSrc(serverImageUrl)\n      \n      // Dispatch command with server URL\n      const payload = { \n        altText, \n        position, \n        showCaption, \n        src: serverImageUrl \n      }\n      \n      activeEditor.dispatchCommand(INSERT_INLINE_IMAGE_COMMAND, payload)\n      onClose()\n    } catch (error) {\n      setUploadError(error instanceof Error ? error.message : 'Failed to upload image to server. Please try again.');\n      console.error('Upload error:', error)\n      setIsUploading(false)\n    }\n  }\n\n  return (\n    <div className=\"grid gap-4 py-4\">\n      <div className=\"grid gap-2\">\n        <Label htmlFor=\"image\">Image Upload</Label>\n        <Input\n          id=\"image\"\n          type=\"file\"\n          onChange={(e) => handleFileChange(e.target.files)}\n          accept=\"image/*\"\n          data-test-id=\"image-modal-file-upload\"\n        />\n      </div>\n      \n      {previewSrc && (\n        <div className=\"grid place-items-center\">\n          <img \n            src={previewSrc} \n            alt=\"Preview\" \n            className=\"max-h-48 max-w-full object-contain rounded-md border border-gray-200\"\n          />\n        </div>\n      )}\n      \n      <div className=\"grid gap-2\">\n        <Label htmlFor=\"alt-text\">Alt Text</Label>\n        <Input\n          id=\"alt-text\"\n          placeholder=\"Descriptive alternative text\"\n          onChange={(e) => setAltText(e.target.value)}\n          value={altText}\n          data-test-id=\"image-modal-alt-text-input\"\n        />\n      </div>\n      <div className=\"grid gap-2\">\n        <Label htmlFor=\"position\">Position</Label>\n        <Select\n          defaultValue=\"left\"\n          onValueChange={(value) => setPosition(value as Position)}\n        >\n          <SelectTrigger id=\"position\">\n            <SelectValue placeholder=\"Select position\" />\n          </SelectTrigger>\n          <SelectContent>\n            <SelectItem value=\"left\">Left</SelectItem>\n            <SelectItem value=\"right\">Right</SelectItem>\n            <SelectItem value=\"full\">Full Width</SelectItem>\n          </SelectContent>\n        </Select>\n      </div>\n      <div className=\"flex items-center space-x-2\">\n        <Checkbox\n          id=\"caption\"\n          checked={showCaption}\n          onCheckedChange={(checked) => setShowCaption(checked as boolean)}\n        />\n        <Label htmlFor=\"caption\">Show Caption</Label>\n      </div>\n      \n      {uploadError && (\n        <div className=\"text-red-500 text-sm p-2 bg-red-50 rounded\">{uploadError}</div>\n      )}\n      \n      <Button\n        data-test-id=\"image-modal-file-upload-btn\"\n        disabled={isDisabled}\n        onClick={handleOnClick}\n      >\n        {isUploading ? (\n          <span className=\"flex items-center gap-2\">\n            <svg className=\"animate-spin -ml-1 mr-2 h-4 w-4 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\n              <circle className=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" strokeWidth=\"4\"></circle>\n              <path className=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\n            </svg>\n            Uploading...\n          </span>\n        ) : (\n          'Upload & Insert'\n        )}\n      </Button>\n    </div>\n  )\n}\n\nexport function InlineImagePlugin({\n  onImageUpload,\n}: {\n  onImageUpload?: (file: File) => Promise<{ url: string }>;\n}): JSX.Element | null {\n  const [editor] = useLexicalComposerContext()\n\n  useEffect(() => {\n    if (!editor.hasNodes([InlineImageNode])) {\n      throw new Error('ImagesPlugin: ImageNode not registered on editor')\n    }\n\n    return mergeRegister(\n      editor.registerCommand<InsertInlineImagePayload>(\n        INSERT_INLINE_IMAGE_COMMAND,\n        (payload) => {\n          const imageNode = $createInlineImageNode(payload)\n          $insertNodes([imageNode])\n          if ($isRootOrShadowRoot(imageNode.getParentOrThrow())) {\n            $wrapNodeInElement(imageNode, $createParagraphNode).selectEnd()\n          }\n\n          return true\n        },\n        COMMAND_PRIORITY_EDITOR\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGSTART_COMMAND,\n        (event) => {\n          return $onDragStart(event)\n        },\n        COMMAND_PRIORITY_HIGH\n      ),\n      editor.registerCommand<DragEvent>(\n        DRAGOVER_COMMAND,\n        (event) => {\n          return $onDragover(event)\n        },\n        COMMAND_PRIORITY_LOW\n      ),\n      editor.registerCommand<DragEvent>(\n        DROP_COMMAND,\n        (event) => {\n          return $onDrop(event, editor)\n        },\n        COMMAND_PRIORITY_HIGH\n      )\n    )\n  }, [editor])\n\n  return null\n}\n\nfunction $onDragStart(event: DragEvent): boolean {\n  const node = $getImageNodeInSelection()\n  if (!node) {\n    return false\n  }\n  const dataTransfer = event.dataTransfer\n  if (!dataTransfer) {\n    return false\n  }\n  const TRANSPARENT_IMAGE =\n    'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'\n  const img = document.createElement('img')\n  img.src = TRANSPARENT_IMAGE\n  dataTransfer.setData('text/plain', '_')\n  dataTransfer.setDragImage(img, 0, 0)\n  dataTransfer.setData(\n    'application/x-lexical-drag',\n    JSON.stringify({\n      data: {\n        altText: node.__altText,\n        caption: node.__caption,\n        height: node.__height,\n        key: node.getKey(),\n        showCaption: node.__showCaption,\n        src: node.__src,\n        width: node.__width,\n        position: node.__position,\n      },\n      type: 'image',\n    })\n  )\n\n  return true\n}\n\nfunction $onDragover(event: DragEvent): boolean {\n  const node = $getImageNodeInSelection()\n  if (!node) {\n    return false\n  }\n  if (!canDropImage(event)) {\n    event.preventDefault()\n  }\n  return true\n}\n\nfunction $onDrop(event: DragEvent, editor: LexicalEditor): boolean {\n  const node = $getImageNodeInSelection()\n  if (!node) {\n    return false\n  }\n  const data = getDragImageData(event)\n  if (!data) {\n    return false\n  }\n  event.preventDefault()\n  if (canDropImage(event)) {\n    const range = getDragSelection(event)\n    node.remove()\n    const rangeSelection = $createRangeSelection()\n    if (range !== null && range !== undefined) {\n      rangeSelection.applyDOMRange(range)\n    }\n    $setSelection(rangeSelection)\n    editor.dispatchCommand(INSERT_INLINE_IMAGE_COMMAND, data)\n  }\n  return true\n}\n\nfunction $getImageNodeInSelection(): InlineImageNode | null {\n  const selection = $getSelection()\n  if (!$isNodeSelection(selection)) {\n    return null\n  }\n  const nodes = selection.getNodes()\n  const node = nodes[0]\n  return $isInlineImageNode(node) ? node : null\n}\n\nfunction getDragImageData(event: DragEvent): null | InsertInlineImagePayload {\n  const dragData = event.dataTransfer?.getData('application/x-lexical-drag')\n  if (!dragData) {\n    return null\n  }\n  const { type, data } = JSON.parse(dragData)\n  if (type !== 'image') {\n    return null\n  }\n\n  return data\n}\n\ndeclare global {\n  interface DragEvent {\n    rangeOffset?: number\n    rangeParent?: Node\n  }\n}\n\nfunction canDropImage(event: DragEvent): boolean {\n  const target = event.target\n  return !!(\n    target &&\n    target instanceof HTMLElement &&\n    !target.closest('code, span.editor-image') &&\n    target.parentElement &&\n    target.parentElement.closest('div.ContentEditable__root')\n  )\n}\n\nfunction getDragSelection(event: DragEvent): Range | null | undefined {\n  let range\n  const target = event.target as null | Element | Document\n  const targetWindow =\n    target == null\n      ? null\n      : target.nodeType === 9\n        ? (target as Document).defaultView\n        : (target as Element).ownerDocument.defaultView\n  const domSelection = getDOMSelection(targetWindow)\n  if (document.caretRangeFromPoint) {\n    range = document.caretRangeFromPoint(event.clientX, event.clientY)\n  } else if (event.rangeParent && domSelection !== null) {\n    domSelection.collapse(event.rangeParent, event.rangeOffset || 0)\n    range = domSelection.getRangeAt(0)\n  } else {\n    throw Error('Cannot get the selection when dragging')\n  }\n\n  return range\n}"]}